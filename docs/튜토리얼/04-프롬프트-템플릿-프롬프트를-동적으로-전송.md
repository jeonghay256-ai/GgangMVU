# ?롬?트 ?플? ?적 ?롬?트 ?송

## ?론??

?통?인 캐릭??카드 ?성 방식?서, ?리??보통 캐릭?의 고정???정??계관??배경 ?토리? ?력?니?? ??꼼꼼???작?라?캐릭?? ?양???계?서 보여?반응까? 구상?곤 ?니?? ?? ?어 ?애??작???? 처음 만났???의 ?도가 ?반??거?? ?정 중? ?건 발생 ?후??계관??변?는 ?이?

????제 ?용 ?계?서 ?러??**?적 변??*?구현?기? ??렵?니?? ?냐?면 AI??매번 ?호?용???마???신???공??**모든 ?보**??어?이?데, AI가 ??보???이?서 주의??Attention)???떻?분배?????리?게 미??이? ?로 ?른 ?황???정?이 ?섞?기 ?기 ?문?니??

**?? ?어 보겠?니??**
?? 먼? **100??* 분량???? 배경???정?고, ??에 주인공이 ?세계로 ?어??립) ?의 ?황??맞춰 **300??* 분량??고? 배경??보충?다?가?해 봅시??
???도??캐릭?? "**?세??립**" ?건??겪? **?에?* AI가 고? 배경???용?여 묘사?는 것입?다.
???결과??종종 ?망???니?? AI???? 고? 배경??분량????길다???유만으? 그것???재??주요 ?정?로 착각??버립?다. 결국 ?체 ?토??인??????빠?? ?도???개?? ?게 ?죠.

??문제??결?기 ?한 ?이?어???실 매우 직??입?다.
**AI가 ?정 조건?에?는 ?장 관???는 ?정??"?보게" 만드??것입?다.**

?래???형?인 "**??블루(All Blue / ?시 ?성??**" ?롬?트 ?시?니??

```text
?이곳? ?? ?계?며, ?야기는 중국?서 발생??  // 배경 ?? ?계관
?뤄? ?자, 17?? 고등?생, 치킨??좋아??     // ?물 ?정
?뤄뤄는 user? 친해지??에?? 매우 ?? 가림?  // ?감?? ?? ?의 ?도
?뤄뤄는 user? 친해??에?? 매우 ?다?이가 ??// ?감?? ?을 ?의 ?도
```

?렇?짧? ?술?라? AI??뤄뤄가 ?재 ?떤 ?태???어???는지 ?마 구별???????을지??모릅?다. ????계관???황??거나 캐릭?? 많아지?????정??복잡??? AI??종종 ?확??처리???려???겪습?다.

?때, ?리???롬?트 ?플?Prompt Template) ?러그인???용?여 ?성???울 ???습?다. ???러그인? ?리가 EJS (Embedded JavaScript) 문법???용?여 ?롬?트??성?????게 ?주? ?정 ?롬?트??송?? 말??**?재??????황(변??**??동?킬 ???게 ?줍?다.

**?감?? ?? ??*, ?리???직 ?음 ?용??송?니??

```text
?이곳? ?? ?계?며, ?야기는 중국?서 발생??
?뤄? ?자, 17?? 고등?생, 치킨??좋아??
?뤄뤄의 ?재 ?감?는 {{format_message_variable::뤄뤄.?감??}?며, ?라??그???매우 ?? 가리는 ?도?보여????// ?감?? ?? ?의 ?도
```

반면 **?감?? 계속 ?승??*???라, ?송?는 ?롬?트???음?같이 변?니??


```
?이곳? ?? ?계?며, ?야기는 중국?서 발생??
?뤄? ?자, 17?? 고등?생, 치킨??좋아??
?뤄뤄의 ?재 ?감?는 {{format_message_variable::뤄뤄.?감??}?며, ?라??그????다?이처럼 ?동?야 ??// ?감?? ?을 ?의 ?도
```

?렇??면, AI??뤄뤄가 지????간 보여줘야 ???도??달받게 ??? ??가지 ?반???태???동???동?? ?게 ?니??

물론, ?의 ?시???리??명?기 ?한 것입?다. ?제 창작 과정?서 ?레?어가 캐릭???격??급격??변?? ?치채? 못하??려? ?리????**부?러???환**??추구?야 ???도 ?습?다.

?라?? ??최적?된 ?계???음?같을 ???습?다.

```
?이곳? ?? ?계?며, ?야기는 중국?서 발생??
?뤄? ?자, 17?? 고등?생, 치킨??좋아??

?감?? 0~40?????송:
?뤄뤄의 ?재 ?감?는 {{format_message_variable::뤄뤄.?감??}?? ???계?서 그???매우 ?? 가리는 ?도?보여???? ?감?? ?름???라, 그???조금????에 ?하?는 ?도?보일 ???음??

?감?? 40~80?????송:
?뤄뤄의 ?재 ?감?는 {{format_message_variable::뤄뤄.?감??}?? ???계?서 그???비교???화???도?보이? ?? <user>? 간단??교류가 가?함. ?감?? ?름???라, 그???????먼? <user>?게 ?담??건넬 ?도 ?음??

?감?? 80~100?????송:
?뤄뤄의 ?재 ?감?는 {{format_message_variable::뤄뤄.?감??}?? ???계?서 그????? ?람?게???전???? 가?????? ?는 ?람, ?히 <user>?게??반드???청???다?이처럼 ?동??것임??
```
?처???계?이??진?인 ?롬?트?? ?전??"?칼???르??一???" 바뀌는 ?태 ?환보다 ?과가 ?씬 ?연?럽?니??

???모든 ?롬?트???신???제 ?요???려 ?습?다. 만약 ?신??구현?고 ?? 것이 캐릭?의 ?적???장???니???계??급?(?? ?고 ?어?더?????서 고??바??라? ?신???롬?트???연???런 부?러???환???요 ?을 것입?다.

?기까? ?해?셨?면, ?러분? EJS??용???택?으??롬?트??송?는 ?심 ?론??마스?하??것입?다.

## ?전??

?? ?제 **?전 ?계**??어가 봅시?? ?리??계속?서 **'?감?에 ?른 ?적 ?물 ?정'**???시??어, ?감???치???라 ?로 ?른 ?롬?트??송?는 기능??직접 구현??보겠?니??

?작?기 ?에, 긴장???세?? 만약 ?로그래?기초가 ?? ?다??래??기호?이 조금 ????껴????습?다. **지극히 ?상?니??**

?리??목표??**?리??해?는 ?*?니?? ?리??면 ?중??AI?게 EJS 코드?짜달?고 ?키거나, ???확?게 AI?지?하??코드??성?게 ?????으? ?시 AI가 ?수?더?도 ?디가 ??는지 직접 찾아?????게 ?니??

### 코드? ?스?? 구분?는 ?심 문법: `<%_ _%>`

?선 ?롬?트 ?플??장??EJS 문법? **"코드 명령??**?**"?반 ?스??** ?에 ?워 ?는 기술?라???을 ?해?야 ?니?? ?스?이 ?디가 ?신?게 ?리??명령(코드)?고, ?디가 AI?게 보낼 ?토??롬?트)?? 구분?게 ?려?**?수???식**???요?니??
??식??바로 `` <%_ _%> ``?니??

?것???종??**"?수??괄호"**?고 ?상??보세??
??괄호?감싸?모든 ?용? ?스?이 **?행?야 ??코드 명령??*??해?니?? 반면, 괄호 밖의 모든 ?용? ?반?인 ?롬?트 ?스?로 간주?여, ?범???드 ?포 ?성 ?용??같??처리?니??

### `if`??용??조건 ?정

EJS?서 ?리가 가???주 ?용?는 명령?는 바로 `` if ``?니??

?기본 구조???음?같습?다.

```javascript
if (?정??조건) {
  ?기??조건???립???만 ?송???롬?트
}
```

??코드??????간단?니?? 만약(if) 괄호 ?의 **"조건"**???립?면, 중괄??{} ?의 ?롬?트가 ?송?다???입?다.

?제, ??구조?EJS??**"?수??괄호"**?감싸보겠?니?? 주의????, if (...) {??명령?의 ?작 부분이?}??명령?의 ??분이므? ?들??각각 ?로 감싸줘야 ?다??것입?다.

```
<%_ if (?정??조건) { _%>
?기??조건???립???만 ?송???롬?트
<%_ } _%>
```

보세?? ?바꿈???니 ?체 구조가 ?씬 ?기 ?워졌죠? ?제 ?시 MVU 카드??코드?을 보면, ?보??조금 ???해?????을 ?같? ?나??

## `getvar()`??용?여 변??가?오?

????제 코드?서 `if` ?의 괄호 ?에???순??"?정??조건"?라??글?? ?어가??것이 ?니?? **?코드**가 ?어갑니??
?리?????코드??성?으로써 ?롬?트? 변???황???결?고, 그에 ?라 ?롬?트 ?송 ????단?게 ?니?? (?? **캐릭???감?? 30보다 ???**)

`` `getvar()` `` ?수가 바로 변???이?? 가?? 주는 **?령(메신?)**?니??
???수???리가 ?서 ?정??변??`` `stat_data` ``) ?에?? ?리?게 ?요???정 변??값을 ?확?게 ?집?냅?다.

**??게???실 별로 ??????**, ???수??용?여 변??값을 가?오??방법? `` `{{format_message_variable::변??}` ``? 거의 비슷?니??

?리??변??구조가 ?음?같다?가?해 봅시??

=== "변??구조 (Schema)"
    ```typescript
    export const Schema = z.object({
      캐릭?? z.object({
        뤄뤄: z.object({
          ?감?? z.coerce.number().transform(value => _.clamp(value, 0, 100)),
        }),
      }),
    })
    ```

=== "변???재?
    ```yaml
    캐릭??
      뤄뤄:
        ?감?? 30
    ```

=== "변??초기?
    <p align="center">
      <img src="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/82c6508e-3e46-4a07-bb28-8112ceaca1f7.jpg" width="400">
    </p>
