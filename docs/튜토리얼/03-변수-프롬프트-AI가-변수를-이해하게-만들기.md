# 변???�롬?�트: AI가 변?��? ?�해?�게 만들�?

지???�에???�리???�공?�으�?변?��? ?�정?�고 초기?�했?�니?? ?��?�??�것?� ?�디까�???**?�리?�번 차원**?�서 캐릭??카드??변?��? ?�당??것일 �? ?�직 AI?�게 "?�런 변?��? ?�다"�??�려주�????��? ?�태?�니?? 비유?�자�??�렇?�니?? 캐릭??카드?�는 보통 ?�로???��?지가 ?�죠? ?��?�??�리가 AI?�게 ?�로 말해주�? ?�으�? AI???�신????캐릭?�에 ?�떤 ?�진??걸어?�?��? ?��? 모르??것과 같습?�다.

그렇?�면, ?�떻�??�야 AI가 ??변?�들??"보고" ?�리???�도?��?조작?�게 만들 ???�을까요? 바로 ?�드 ?�포(World Info)??**?�롬?�트**�??�성?�서, AI?�게 변?�에 ?�??**3가지 ?�심 ?�보**�??�려줘야 ?�니??

## 변?�의 3가지 ?�심 ?�보

**변??목록 (Variable List)**
* ?�재 변?�의 값�? ?�마?��?? 그리�?�?값�? ?�떤 ?��??��??
* *?�시:* `?�쿠???�존???�는 변?�의 ?�재 ?�치?? 0???��? 100????각각 무슨 ?�인가?

**변???�데?�트 규칙 (Variable Update Rules)**
* 변?�는 ?�떤 ?�황?�서 ?�데?�트?�어???�며, ?�떤 값으�?변?�야 ?�는가?
* *?�시:* `?�쿠???�존?????�떤 ?�토�??�개?�서 ?�승?�야 ?�고, 반�?�??�떤 ?�황?�서 ?�락?�야 ?�는가?

**변??출력 ?�식 (Variable Output Format)**
* AI??변?��? ?�데?�트?�기 ?�해 **무엇??출력**?�야 ?�는가?
* *?�시:* AI가 "?�쿠?��? 주인공과 ?�이?��? ?�으??`?�쿠???�존??�?20?�서 25�??�려?�겠??�??�단?�다�? MVU ?�크립트가 ?��? ?�아?�고 ?�제�?25�?고칠 ???�도�?**?�떤 ?�스?��? ?�뱉?�야 ?�는가?**



!!! question "?�시 ?�해가 ?????�시?�요? ?�ㅠ"
    ?�... ?�른 비유�??�나 ???�어볼게?? 만약 ?�리가 **"?�토�?진행???�라 AI가 ?�아??캐릭???�사�?바꾸�?** 만들�??�다�??�떻�??�야 ?�까??

    * **변??목록:** ?�재 캐릭?�의 ?�사??무엇?��?? (?�는 ?�굴? ?�는 ?�굴?) 그게 무슨 ?��??��??
    * **변???�데?�트 규칙:** 캐릭???�사???�떤 ?�황?�서 바뀌어???�는가? (?�픈 ?�엔 ?�는 ?�굴�?)
    * **변??출력 ?�식:** AI가 ?�사�?바꾸?�면 무엇??출력?�야 ?�는가? (?�마??직접 ?��?지 ?�일??출력?�거?? ?�일명을 말해?�겠�? 그러�?'?�사 교체 ?�크립트'가 그걸 보고 ?�진??바꿔�?겁니??)



## ??가지 변???�롬?�트 간단?�게 ?�작?�기

?�러분이 머리�??�맬 ?�요 ?�이, 거의 **거�?먹기 ?��?**?�로 변??목록, ?�데?�트 규칙, 출력 ?�식???�을 ???�는 방법???�습?�다.

### 1. `[mvu_update]` 변???�데?�트 규칙
?�전??'변??구조 ?�계'�??�성?????�던 채팅???�어??진행?�니?? **[문�?�?카드 ?�성 ?�우�?- 변???�데?�트 규칙(Variable Update Rules)]** ??��?�로 ?�환???? ?�별??강조?�고 ?��? 규칙???�력?�고 AI?�게 ?�성???�청?�세?? �????�성??결과�??�맛??맞게 조금�??�듬?�면 ?�니??
> *?�시 ?�력:* "`?�쿠????`�?��`??반드??주인공에 ?�???�쿠?�의 ?�도�?반영?�서 변?�야 ??"

### 2. `[mvu_update]` 변??출력 ?�식 �?변??목록
?�건 ???�습?�다. 그냥 ?�우미�? ?�성??준 **`[mvu_update] 변??출력 ?�식`**�?**`변??목록`** ?�용??그�?�?복사?�세??

?�렇�??�면 ?�리??**3?� 변???�롬?�트**�?모두 ?�에 ?�게 ?�니?? ?�제 ?�래 그림처럼 ?�정??마치�? AI??비로??변?��? ?�해?�고 ?�스�??�데?�트?????�게 ?�니??

?�음?�로, **?�리?�번 ?�측 ?�단 블록 ?�이�?Extensions)** ??**?�규??Regex)**?�로 ?�동?�여, ?�래 버전 �??�나�?골라 3개의 ?�규???�크립트�?**로컬 ?�규??Local Regex)**?�로 가?�옵?�다.

* **?�쁘�?꾸�? 버전** ([?�시 보기](https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/%E7%BE%8E%E5%8C%96%E7%89%88.mp4)): <a href="../../assets/files/regex-remove-variable-update.json" download="regex-[不发???�除?�量?�新.json">`[?�송?�함]변???�데?�트 ?�거`</a>, <a href="../../assets/files/regex-beautify-variable-updating.json" download="regex-[美化]?�量?�新�?json">`[미화]변???�데?�트 �?</a>, <a href="../../assets/files/regex-beautify-variable-complete.json" download="regex-[美化]完整?�量?�新.json">`[미화]변???�데?�트 ?�료`</a>
* **?�기 버전** ([?�시 보기](https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/%E6%8A%98%E5%8F%A0%E7%89%88.mp4)): <a href="../../assets/files/regex-remove-variable-update.json" download="regex-[不发???�除?�量?�新.json">`[?�송?�함]변???�데?�트 ?�거`</a>, <a href="../../assets/files/regex-fold-variable-updating.json" download="regex-[?�叠]?�量?�新�?json">`[?�기]변???�데?�트 �?</a>, <a href="../../assets/files/regex-fold-variable-complete.json" download="regex-[?�叠]完整?�量?�新.json">`[?�기]변???�데?�트 ?�료`</a>
* **?�림 ?�용 버전** (?�용 ?�치�?불�?): <a href="../../assets/files/regex-remove-variable-update.json" download="regex-[不发???�除?�量?�新.json">`[?�송?�함]변???�데?�트 ?�거`</a>, `[?�림]변???�데?�트 �?, `[?�림]변???�데?�트 ?�료`

(?�림 ?�용 버전?� 문서 ?�에???�본 ?�일????��?�어???�음 ?�해 바람)

?�렇�??�면 변???�롬?�트 ?�성???�났?�니, 바로 ?�음 ?�으�??�어가?�도 ?�니?? ?��?�?�??�롬?�트가 ?��?�?**무슨 ??��???�고, ?�떤 ?�리�??�동?�는지** ?�번 짚고 ?�어가??것을 강력 추천?�니??

## 변??목록

변??목록?� AI?�게 **변?�의 ?�재 값이 ?�마?��?**, 그리�?**변?��? ?�떤 ?��??��?**�??�려주는 ??��???�니??

?��?�?'문�?�?카드 ?�성 ?�우�????�성??변??목록 ?�롬?�트�?보면 코드가 매우 간단?�니??

```xml
---
<status_current_variable>
{{format_message_variable::stat_data}}
</status_current_variable>
```

?��?�???간단??코드�??�떻�?AI가 변?�의 값과 ?��?�??????�다??걸까??

�??�유??바로 메시지가 ?�제�??�송???? {{format_message_variable::stat_data}} 부분이 그�?�??�아가??것이 ?�니???�제 변???�용?�로 교체(치환)?�어 ?�송?�기 ?�문?�니??

=== "?�롬?�트"

    ```xml
    ---
    <status_current_variable>
    {{format_message_variable::stat_data}}
    </status_current_variable>
    ```

=== "AI?�게 ?�송??결과"

    ```yaml
    ---
    <status_current_variable>
    ?�계:
      ?�재 ?�간: 2024??4??8??10:45
      ?�재 ?�소: ?�립 카자마츠�??�원 고등부 2?�년 A�?교실
      최근 ?�건:
        ?�학??배치: ?�쿠?��? �??�학 ?? 교재�??�령?�고 ?�교 ?�경???��?????
        ?�리 조정: 반장??최종 좌석?��? ?�인 중이�? 미세??조정???�을 ???�음
        ?�심?�간 ?�박: ?�심?�간까�? ?�업?????�나 ?�음. ?�쿠?��? ?�촉??기회??
    백아:
      ?�존?? 35
      복장:
        ?�의: 깔끔??짙�? ?�색 교복 ?�킷, ?�추�??�나?�나 꼼꼼?�게 채�?
        ?�의: ?�정??짙�? ?�색 주름치마, 무릎까�? ?�는 길이
        ?�옷: 무늬 ?�는 ?�색 ?�옷 ?�트
        ?�말: 검?�???�버?�삭?? 주름 ?�나 ?�이 ?�팽??
        ?�발: 검?�??가�??�생?? 반짝?�게 ??�� ?�음
        ?�신�? ?�음
      �?��:
        ?�시(Living Dead):
          ?�과: ?�상 ?�동?�서 명백??권태감과 기계?�인 ?�낌??묻어??
          ?�평: ?�아?�는 �??�체가 ?�벌?�야
        ?�피??
          ?�과: �?��?�의 모든 ?�근??본능?�으�??�피??
          ?�평: ??�??�람 ?�생???��????�격???�어
    주인�?
      ?��???
        ?��? 반창�?
          ?�명: 지�??�쪽??2???�안 ?�어??캐릭??반창�? ?�착?��? ?�마 ???�라졌을 것임
          ?�량: 1
        박하?�탕:
          ?�명: ??�???먹는 강력 박하?�탕. ?�전??그�??????�새�??�주 ?�어?�음
          ?�량: 1
    </status_current_variable>
    ```

=== "?�롬?�트 검?�기"

    ![?�롬?�트 검?�기](https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/8bf79453-8ebd-4b21-85e2-ecd530b05a1a.png)


?�롬?�트?� ?�제�??�송?�는 ?�용???�로 ?�른 경우???�번??처음???�닙?�다.

캐릭??카드�??�나 ?�어??**?�프??메시지(Greeting)**�??�인??보세?? 분명 ?�성???�는 `<user>`?�고 ?�었지�? ?�면???�시?�거??AI?�게 ?�송???�는 구체?�인 ?�용???�름?�로 바뀌어 ?�는 것을 �????�습?�다.    

<p align="center">
  <img src="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/40b06506-a303-483a-861f-70694538613d.png" width="400">
</p>

�? `{{format_message_variable::stat_data}}`, `<user>` 같�? ?�스?�는 ?��? **?�리 ?�시??* ??��????뿐이�? ?�제�??�면???�시?�거???�송???�는 **구체?�인 ?�용?�로 교체**?�니??

?�러???�리 ?�시 ?�스?��? **"매크�?**?�고 부릅니??

* `<user>` ?�는 `{{user}}`??**?�리?�번 기본 매크�?*?�니?? ?�리?�번 ?�력창에 `/help macros`�??�력?�고 ?�터�?치면 ?�리?�번???�떤 매크로들???�공?�는지 ?????�습?�다.
* 반면, `{{format_message_variable::변??}`??**?�리?�번 ?�우�?MVU)가 ?�로 ?�록??매크�?*?�니??

### ?�리?�번 ?�우�?매크�?`{{format_message_variable::변??}`

?�리?�번??기능???�장?�고 변?��? ????지?�하�??�해, ?�리?�번 ?�우미는 ?�용?��? 직접 **?�우�?매크로�? ?�록**?????�도�??�용?�며, 미리 `{{format_message_variable::변??}` 매크로�? ?�공?�고 ?�습?�다. ??매크로의 ??��?� **최신 메시지 �?Layer/Floor)??변??값을 보여주는 �?*?�니??

?�기??`변?????�시?�려??**변?�의 경로(Path)**�??�합?�다. �? `{{format_message_variable::stat_data}}`??`stat_data` 경로 ?�래???�는 변???�용??보여준?�는 ?�입?�다.

...?��??�우?��??? 괜찮?�니?? ?�시 ?�번 <span class="highlight-box">**?�리?�번 ?�력�??�쪽 마술�??�이�???변??관리자 ??메시지**</span> ??�� ?�어???�으�??�인??봅시??

<p align="center">
 <img src="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/4290386d-e62d-4230-b420-6dc502b59446.png" width="400">
 </p>

 `stat_data` 변???�래?�는 ?�?�게???�리가 ?�정??**모든 변??*가 ?�어?�습?�다!

?�라??`{{format_message_variable::stat_data}}`�??�용?�면, ?�리가 ?�정??모든 변?�들???�해�??�식??맞춰 ??번에 ?�시?�는 것입?�다! **변??목록** ?�롬?�트??바로 ???�을 ?�용?�고 ?�습?�다.

```xml
---
<status_current_variable>
{{format_message_variable::stat_data}}
</status_current_variable>
```

?��?�?{{format_message_variable::변??} 매크로는 stat_data뿐만 ?�니???�른 경로???�용?????�습?�다.

?�번 변??관리자?�서 ?�른 경로�?복사?�서 ?�스?�해 봅시?? **"?�재 ?�간(Current Time)"**???�릭???�음, 변??관리자 ?�단???�색 바�? ?�러 ?�집 ?�태�?만들�? �?경로�?복사??보세??

<p align="center">
  <img src="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/40b06506-a303-483a-861f-70694538613d.png" width="400">
</p>

?�리가 ?��? 경로??`stat_data.?�계.?�재 ?�간`?�니?? 그러므�??�리?�번 ?�력창에 `{{format_message_variable::stat_data.?�계.?�재 ?�간}}`???�력?�고 ?�번 ?�송??봅시??

<p align="center">
<img src="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/4d46cff7-1aa1-4329-af04-fdb94c6fc0a0.png" width="400">
</p>

?�상?��?AI???��???`2024-04-08 10:45`?�는 ?�간???�확???��??�습?�다!

!!! tip "??
    ???�양???�리?�번 ?�우�?매크로의 ?�용법�? [<u>?�리?�번 ?�우�?매크�?문서</u>](https://n0vi028.github.io/JS-Slash-Runner-Doc/guide/%E5%8A%9F%E8%83%BD%E8%AF%A6%E6%83%85/%E9%85%92%E9%A6%86%E5%8A%A9%E6%89%8B%E5%AE%8F.html)�?참고?�세??

## AI?�게 변??목록??값이 '최신'?�을 ?�식?�키�?

변??목록?� 변?�의 ?�재 값을 ?�열?�고 ?�습?�다. ?��?�?AI???�전??변??목록??값들??**최신 ?�토�?*???�당?�는 것이 ?�니?? ?�전???�떤 ?�점???�당?�다�?착각?????�습?�다. ?�것?� ?�리가 ?�정??**?�드 ?�포(World Info) ??��???�입 ?�치** ?�문??발생?�는 문제?�니??

?�반?�으�? 기본 ?�정?�서???�롬?�트가 ?�음�?같�? ?�서�?AI?�게 ?�송?�니??

```xml
* 캐릭???�의 ?�전
* 캐릭???�의 ?�후
* 0번째 메시지
* 1번째 메시지
* ...
* ?�에??3번째 메시지
* @D2
* ?�에??2번째 메시지 (마�?�?AI ?�답)
* @D1
* ?�에??1번째 메시지 (마�?�??�용???�력)
* @D0
```

?�기??`메시지(�?`???�레?�어???�력�?AI???�답???��??�니??

?�라??AI가 **"변??목록???�용??최신 ?�토�?�? 가??최근??AI ?�답)?� ?�?�된??**??것을 바로 ?�해?�게 ?�려�? 변??목록??**@D1** ?�는 **@D0** ?�치??배치?�야 ?�니??

<p align="center">
 <img src="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/93f79570-1e89-454d-b3e2-944d60f30248.png" width="400">
</p>

## 변?�의 ?��? 구체?�으�??�명?�기

변??목록?� AI?�게 변?�의 **?�재 �?*???�마?��? ?�려주는 �??�에?? �?변?��? **?�떤 ?��??��?** ?�명?�는 ??��???�니??

`?�계.?�재 ?�간`, `?�계.?�재 ?�소`, `주인�??��??? ?�과 같이 ?�름�?봐도 �??��?�??????�는 변?�들???��?�? ?�수???��?�?가지�??�어 **추�??�인 ?�명???�요??변??*?�도 ?�습?�다.

?��? ?�어 `?�쿠???�존????경우, AI???�름�?보고???�것??'백아가 주인공에�??��??�는 ?�도'?�는 것�? ?????�습?�다. ?��?�?**구체?�인 ?�치(?? 23)**????백아가 ?�떤 ?�리 ?�태?�야 ?�는지, ?�떤 ?�동??취해???�는지???????�습?�다.

?�것??바로 많�? 카드 ?�작?�들??말하??**"구간�??�감??** 메커?�즘?�니?? �? ?�존???�치???�라 백아???�로 ?�른 ?�동�??�리 ?�태�?보여???�니??

?�선?� **[캐릭???�계]** ??��???�로 만들�? �??�에 ?�존?�별 백아???�동 ?�식??간단???�열??�????�습?�다.

```text
?�쿠?�의 ?�재 ?�동: # ?�쿠?�의 ?�재 ?�존?�는 {{format_message_variable::stat_data.백아.?�존??} ?�니?? ?�라???�쿠?�는 ?�래 ?�시?� ?�사???�동??취하?�는 경향???�습?�다.
  # 0~19 ????
  ?�극???�기 ?�괴:
    ...
  # 20~39 ????
  관??갈구:
    ...
  # 40~59 ????
  몰래 ?�근:
    ...
  # 60~79 ????
  불안???�행:
  # 80~100 ????
  ?�순???�존:
    ...
```

?��?�???방법?�는 분명??문제가 ?�습?�다. ?�재 ?�쿠?�의 ?�존?�는 23?�데, ?�리??0~19, 40~59 ???�당?��? ?�는 ?�계???�롬?�트까�? 모두 ?�송?�고 ?�습?�다. ?�는 ?�력 ?�큰????��??뿐만 ?�니?? AI??주의?�을 분산?�켜 백아가 ?�확???�떤 ?�계???�동???�야 ?��? ?��??�럽�?만들 ???�습?�다.

?�음 ?�에???�롬?�트 ?�플릿을 ?�용?�여 ??문제�?깔끔?�게 ?�결?�는 방법???�려?�리겠습?�다. 지금�? ?�시 ?�아?�?? 3?� 변???�롬?�트 �???번째??변???�데?�트 규칙???�??먼�? ?�아보겠?�니??

## 변???�데?�트 규칙 (Variable Update Rules)
변???�데?�트 규칙?� AI?�게 ?�떤 ?�황?�서 변?��? ?�데?�트?�어???�는지, 그리�??�떤 값으�??�데?�트?�어???�는지�??�려줍니??

'문의 주인(Gatekeeper) 캐릭??카드 ?�성 ?�우�???변???�데?�트 규칙 ?�성법�? 변??구조, 변??초깃�? 변??목록�??�사?�니??

???+ info "?�성??변???�데?�트 규칙"

    ```yaml
    변???�데?�트 규칙:
      ?�계:
        ?�재 ?�간:
          format: YYYY?�MM?�DD???�일X HH:MM
        최근 ?�건:
          type: |-
            {
              [?�건�? string]: string; // ?�건 ?�명
            }
          check:
            - ?�수?�야 ???�무, ?�속, 중요 ?�건 ?�을 기록
            - ?�료 ??목록?�서 ?�거, ?�로???�건 발생 ??즉시 추�?
            - ?�성 ?�건?� 최�? 5~8개로 ?��??�여 지?�친 복잡??방�?
      바이??
        ?�존??
          type: number
          range: 0~100
          check:
            - <user>???�동???�???�쿠?�의 ?��??� 반응???�라 조정 ±(3~6)
            - ?�쿠?��? ?�재 <user>???�동???�아차렸???�만 ?�데?�트
        복장.${?�의|?�의|?�옷|?�말|?�발|?�신�?:
          check:
            - ?�복, ?�복 ?�상, ?�수 ?�황 ???�데?�트
            - ?�상, ?�질, ?��????�의 ?�테???�함?�여 묘사
            - ?�쿠?�의 ?�리 ?�태?� <user>???�??관???�도�?반영
        �?��:
          type: |-
            {
              [�?���? string]: {
                ?�과: string;
                ?�기?��??: string;  // 기본값�? '?��? ?��?
              }
            }
          check:
            - ?�쿠?�의 중요 ?�동, ?�리 변???�는 <user>?�???�호?�용??기반?�여 ?�득
            - ?�기?��?가 '?��? ?��??�면, 즉시 ?�로???�기?��?�??�데?�트
            - �?��???�쿠?�의 ?�재 ?�존 ?�태?� ?�리??발전??반영?�야 ??
            - 최�? Math.ceil(?�존??10)개의 �?�� ?��?, 초과 ??가??먼�? ?�득??것�????�거
      주인�?
        ?�이???�롯:
          type: |-
            {
              [?�이?�명: string]: {
                ?�명: string;
                ?�량?: number;  // 기본값�? 1
              }
            }
          check:
            - ?�이???�득, ?�모, 버리�????�량 ?�데?�트
            - ?�량??0???�면 ?�당 ??�� ?�시 ????
    ```


?��? ?�어 ?�쿠???�존?��? ?�쿠??�?��???�음�?같이 ?�열?�니??

=== "변??목록"

    ```yaml
    ?�쿠??
      ?�존?? 15
      �?��:
        ?�학??
          ?�과: �??�학 ?�???�경????��. ?�?�의 주의�??�기 ?��?�?본인?� ?�에 ?��? ?�으????
          ?�기?��?: ???�로???�작?��?�? ??분명 ?�시 모든 �?망칠 거야
    ```

=== "변???�데?�트 규칙"

    ```yaml
    변???�데?�트 규칙:
      ?�쿠??
        ?�존??
          type: number
          range: 0~100
          check:
            - <user>???�동???�???�쿠?�의 ?��??� 반응???�라 조정 ±(3~6)
            - ?�쿠?��? ?�재 <user>???�동???�아차렸???�만 ?�데?�트
        �?��:
          type: |-
            {
              [�?���? string]: {
                ?�과: string;
                ?�기?��??: string;  // 기본값�? '?��? ?��?
              }
            }
          check:
            - ?�쿠?�의 중요 ?�동, ?�리 변???�는 <user>?�???�호?�용??기반?�여 ?�득
            - ?�기?��?가 '?��? ?��??�면, 즉시 ?�로???�기?��?�??�데?�트
            - �?��???�쿠?�의 ?�재 ?�존 ?�태?� ?�리??발전??반영?�야 ??
            - 최�? Math.ceil(?�존??10)개의 �?�� ?��?, 초과 ??가??먼�? ?�득??것�????�거
    ```

## 변???�데?�트 규칙?�서 변??구조�??�용?�는 ?�유

변???�데?�트 규칙?�서 변??구조�?그�?�??�용?�는 것의 ?�점?� 분명?�니?? AI가 �??�데?�트 규칙???�떤 변?�에 ?�당?�는지 ?�게 ?????�으�? ?�일??구조�??�용?�으로써 AI??변??구조???�???�해�??�층 ??강화?????�습?�다.

---

### �??�드???��?

'문의 주인(Gatekeeper) 카드 ?�성 ?�우�???변???�데?�트 규칙?�서 AI???�음�?같�? ?�드�??�용?????�습?�다.

!!! tip "추천"
    ?�우미�? ?�성??준 것을 그�?�??�용?�되, 불필?�한 규칙?� 지?�고 `check` 부분만 ?�정?�는 것을 추천?�니??

#### `type` - 변?��? 지?�하???�형

> **??** `?�쿠???�존?????�치(`number`)?�고, ?�무 진행?�는 `'미수??|'진행 �?|'?�료'`?????�습?�다.

?�성??변??구조?�서 ?��? ?�떤 ?�형??지?�하?��? 규정?��?�? AI???�직 모�? ???�습?�다. ?�라???�기??AI?�게 명시?�주????�� ?�용 가?�한 값으�?변?��? ?�데?�트?�도�??�니??

#### `range` - ?�치 변?��? 반드???�치?�야 ??범위

> **??** `?�쿠???�존????반드??`0~100` ?�이?�야 ?�니??

???�한 변??구조??규정?�어 ?��?�? AI?�게 ?�시 ?�려주는 ?�이 좋습?�다. AI가 ?�존?��? 128�??�데?�트?�다가 100?�로 ?�정?�는 것보?? ?�초???�존?��? 0~100 ?�이?�야 ?�을 ?�고 ?�는 ?�이 ?�기 ?�문?�니??

#### `format` - 변?��? 만족?�야 ???�정 ?�식

> **??** `?�계.?�재 ?�간`?� 반드??`YYYY?�MM?�DD???�일X HH:MM`?�어???�니??

?�것 ??�� 변??구조?�서 규정?????��?�? ?�시 카드?�서??그렇�??��? ?�고 변???�데?�트 규칙??`format: ...` ??줄을 ?�어 AI가 ?��? ?��??�게 ?�습?�다.

!!! note "??format??별도�??�까??"
    ?�시 카드?�서 `?�계.?�재 ?�간`?� AI가 ?�재 ?�간???�게 ?�기 ?�함??�? ?�식??만족?��? ?�아???��??�기 ?�문?�니?? `HH:MM YYYY/MM/DD`?�도 ?�요�?충족?�니??

!!! info "?�약"
    - **변??구조** = 변?�에 ?�??**'강제???�구 ?�항'**
    - **변???�데?�트 규칙??`type`, `range`, `format`** = AI가 변?��? ?�떤 값으�??�데?�트?�야 ?�는지???�??**'?�망 ?�항/?�안'**

#### `check` - AI가 변?��? ?�데?�트????고려?�야 ???�소

> **??** `?�쿠???�존?????�쿠?�의 `<user>` ?�동???�???��??� 반응???�라 ±(3~6) 조정?�어???�며, `?�쿠??�?��`???�쿠?�의 중요 ?�동, ?�리 변???�는 `<user>`?�???�호?�용??기반?�여 ?�득?�야 ?�니??

?�는 ?�제�??�리가 **변?��? ?�떤 ?�황?�서 ?�데?�트?�어???�는지**, **?�떤 값으�??�데?�트?�어???�는지**�??�는 부분입?�다. ?�연?�로 ?�구 ?�항???�술?�면 ?�니??

---

### 변???�데?�트 규칙??중복 ?�성 ?�하�?

물론 변??목록??맞춰 모든 변?�의 ?�데?�트 규칙???�일???�열???�도 ?��?�? ?�는 ?�청??반복 ?�업�?�?가지 ?�려?�???�반?�니??

| 문제 ?�황 | ?�명 |
|-----------|------|
| **?�름?�로 충분??경우** | `?�계.?�재 ?�소` 같�? 변?�는 ?�름 ?�체가 AI?�게 ?�떻�??�데?�트?�야 ?��? ?�려주�?�? 굳이 규칙???�로 ???�요가 ?�습?�다. |
| **규칙???�일??경우** | `?�쿠??복장.?�의`, `?�쿠??복장.?�의` 같�? 변?�는 ?�데?�트 규칙??거의 같으므�?반복?�서 ???�요가 ?�습?�다. |
| **?�적 ??��??경우** | `�?��` 같�? 변?�는 �??�에 ?�떤 ??��???�어갈�? ?????�으므�? 규칙???�일???�열?????�습?�다. |

?�시 카드??변???�데?�트 규칙??보면 '문의 주인 카드 ?�성 ?�우�?가 ??문제?�을 ?��? 고려?�음???????�습?�다:

- **?�름?�로 충분??변??* ??`?�계.?�재 ?�소`처럼 ?�름만으�??????�는 변?�는 **?�략**?�니?? 

- **규칙???�일??변??* ??`?�쿠??복장.?�의`, `?�쿠??복장.?�의` 같�? 변?�는 **병합**?�여, `?�쿠??복장.${?�의|?�의|?�옷|?�말|?�발|?�신�?`?� 같이 ?�합???�데?�트 규칙???�성?�니?? 

- **?�적 ??��** ??`�?��` ?�래??�?��명이 ?�의??값임???�해?�고, �?��명을 `type` 부분에 ?�어 ?�명?�니?? *(직접 ?�성????.. 괜찮?�니?? ?�직 type??�??�는 �??�상?�니?? 부록에???�려?�릴게요!)*

---

### 변??구조�?변???�데?�트 규칙??직접 ?�용?�기

'문의 주인 카드 ?�성 ?�우�??�게 규칙 ?�성??맡기??�??�에, ???�른 ?�령?� **?�성??변??구조�?변???�데?�트 규칙??그�?�??�용**?�는 것입?�다.

?�서 ?�명???�드?�의 ?��?�?보면 ?????�듯?? `type`, `range`, `format` 같�? ?�드??모두 변??구조??규정???�용?�니?? **?�리가 ?�일?�게 채워 ?�어????부분�? `check` 부분뿐?�니??**

?��? ?�어, 변???�데?�트 규칙??바로 ?�음�?같이 채울 ???�습?�다:

=== "변??구조"

    ```javascript hl_lines="6"
    import { registerMvuSchema } from '[https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/util/mvu_zod.js](https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/util/mvu_zod.js)';

    export const Schema = z.object({
      ?�쿠?? z
        .object({
          ?�존?? z.coerce.number().transform(v => _.clamp(v, 0, 100)),
        })
    });

    $(() => {
      registerMvuSchema(Schema);
    });
    ```

=== "변??구조�?type???�용"

    ```yaml hl_lines="5"
    ---
    변???�데?�트 규칙:
      ?�쿠??
        ?�존??
          type: z.coerce.number().transform(v => _.clamp(v, 0, 100))
          check:
            - <user>???�동???�???�쿠?�의 ?��??� 반응???�라 조정 ±(3~6)
            - ?�쿠?��? ?�재 <user>???�동???�아차렸???�만 ?�데?�트
    ```

=== "변??구조 ?�체 복사"

    ```yaml hl_lines="6-10"
    ---
    ?�量?�新规则: |-
      z.object({
        ?�쿠?? z
          .object({
            /**
             * check:
             * - <user>???�동???�???�쿠?�의 ?��??� 반응???�라 조정 ±(3~6)
             * - ?�쿠?��? ?�재 <user>???�동???�아차렸???�만 ?�데?�트
             */
            ?�존?? z.coerce.number().transform(v => _.clamp(v, 0, 100)),
          })
      });
    ```

### 변???�데?�트 규칙???�입 ?�치

변??목록??최신 ?�토리�? 반드??묶여???�는 것과 ?�리, **변???�데?�트 규칙**?� ?�토�??�개?� 무�???경우가 많습?�다. ?�라??굳이 **D1**?�나 **D0** ?�치???�입???�요가 ?�습?�다.

?�러분�? 변???�데?�트 규칙???�토�??�개?� ?��??�는 ?�치, ?��? ?�어 **캐릭???�의 ??*??**캐릭???�의 ??* ?�에 ?�유�?�� ?�입?????�습?�다. **Claude** 모델??경우 **D3, D4** ?�의 ?�치???�을 ?�도 ?�습?�다. ?�러???�치??AI??주의??Attention)???�게 ?�유?��?�? AI가 ?�른 ?�롬?�트????집중?????�게 ?�줍?�다.
(물론 귀�?���??�하�?**D0**???�셔???�니??..)

??? question "변???�데?�트 규칙??주의�???기울?�게 ?�면, ?�류가 ?�기지 ?�을까요?"
    "그렇?�니?? ?��?�?**변??출력 ?�식**???�함??**?�고???�쇄(Chain of Thought, CoT)**가 ???�을 보완??�?것입?�다."

---

### 변??출력 ?�식

변??출력 ?�식?� AI?�게 **변?��? ?�데?�트?�기 ?�해 무엇??출력?�야 ?�는지** ?�려줍니??

'문의 주인(Gatekeeper) 카드 ?�성 ?�우�???변??출력 ?�식?� **Qingkongli**??[추�? 출력 ?�식](#) ?�법??채택?�습?�다.
* `rule` 부분�? **출력 규칙**?�니??
* `format` 부분�? **출력 ?�식**?�니??

AI???�에 ?�라 ?�답(Reply) 중에 **변??출력 ?�식**??지?�한 ?�식??맞춰 변?��? ?�데?�트?�니??

=== "?�문 ?�롬?�트"

    ```yaml
    ---
    변??출력 ?�식:
      rule:
        - you must output the update analysis and the actual update commands at once in the end of the next reply
        - the update commands works like the **JSON Patch (RFC 6902)** standard, must be a valid JSON array containing operation objects, but supports the following operations instead:
          - replace: replace the value of existing paths
          - delta: update the value of existing number paths by a delta value
          - insert: insert new items into an object or array (using `-` as array index intends appending to the end)
          - remove
        - don't update field names starts with `_` as they are readonly, such as `_Variable`
      format: |-
        <UpdateVariable>
        <Analysis>$(IN ENGLISH, no more than 80 words)
        - ${calculate time passed: ...}
        - ${decide whether dramatic updates are allowed as it's in a special case or the time passed is more than usual: yes/no}
        - ${analyze every variable based on its corresponding `check`, according only to current reply instead of previous plots: ...}
        </Analysis>
        <JSONPatch>
        [
          { "op": "replace", "path": "${/path/to/variable}", "value": "${new_value}" },
          { "op": "delta", "path": "${/path/to/number/variable}", "value": "${positve_or_negative_delta}" },
          { "op": "insert", "path": "${/path/to/object/new_key}", "value": "${new_value}" },
          { "op": "insert", "path": "${/path/to/array/-}", "value": "${new_value}" },
          { "op": "remove", "path": "${/path/to/object/key}" },
          { "op": "remove", "path": "${/path/to/array/0}" },
          ...
        ]
        </JSONPatch>
        </UpdateVariable>
    ```

=== "?�국???�롬?�트"

    ```yaml
    ---
    변??출력 ?�식:
      rule:
        - 반드???�장 ?�에 ?�데?�트 분석�??�제 ?�데?�트 명령????번에 출력?�야 ?�니??
        - ?�데?�트 명령?� **JSON Patch (RFC 6902)** ?��?�??�사?�게 ?�동?�며 ?�효??JSON 배열?�어???��?�? ?��? ?�???�음 ?�업?�을 지?�합?�다:
          - replace: 기존 경로??값을 교체
          - delta: 변??값을 ?�용?�여 기존 ?�치 변??경로??값을 ?�데?�트
          - insert: 객체??배열??????�� ?�입 (배열 ?�덱?�로 `-` ?�용 ???�에 추�?)
          - remove: ?�거
        - `_`�??�작?�는 ?�드명�? ?�기 ?�용?��?�??�데?�트?��? 마세??(?? `_변??)
      format: |-
        <UpdateVariable>
        <Analysis>$(?�어�?출력, 80?�어 ?�내)
        - ${경과???�간 계산: ...}
        - ${?�재 ?�황??충분???�수?�거???�간 경과가 ?�상 범위�??�씬 초과?�여, 변??값의 극적??변?��? ?�용?��? 결정: ???�니??
        - ${변?�에 ?�?�하??`check`??기반?�여, ?�전 ?�토리�? ?�닌 ?�직 ?�재 ?�장만으�?�?변?�의 ?�데?�트 ?�요??분석: ...}
        </Analysis>
        <JSONPatch>
        [
          { "op": "replace", "path": "${/변??경로}", "value": "${?�값}" },
          { "op": "delta", "path": "${/?�치/변??경로}", "value": "${?�수_?�는_?�수??변?�값}" },
          { "op": "insert", "path": "${/객체/?�키/경로}", "value": "${?�값}" },
          { "op": "insert", "path": "${/배열/-}", "value": "${?�값}" },
          { "op": "remove", "path": "${/객체/??경로}" },
          { "op": "remove", "path": "${/배열/경로/0}" },
          ...
        ]
        </JSONPatch>
        </UpdateVariable>
    ```

=== "AI 출력 결과 ?�시"

    ```xml
    ?�토�?부�?..

    <UpdateVariable>
    <Analysis>
    - Time advanced by 10 minutes (from 10:47 to 10:57) for the class break and the subsequent interaction.
    - Special Case? No, routine plot progression, no dramatic time skips.
    - ?�쿠???�존?? Baiya showed a strong reaction to Qingkong Li (trembling, calling him "brother", self-denial but accepting the candy secretly). She definitely noticed his attention and action. This indicates a significant emotional impact, warranting an increase.
    - ?�쿠??�?��: The "?�빠(Brother)" slip-up and the immediate self-punishment reinforce her internal conflict, but doesn't necessarily grant a new title yet. Her current titles are still very relevant.
    - 주인�??�이???�롯: The mints were placed on Baiya's desk. The item should be removed from inventory.
    - ?�계.최근 ?�건: "?�학???�리 배치" is ongoing but the specific interaction happened. "?�심?�간 ?�박" is becoming more relevant as break continues.
    </Analysis>
    <JSONPatch>
    [
      { "op": "replace", "path": "/?�계/?�재?�간", "value": "2024-04-08 10:57" },
      { "op": "replace", "path": "/?�쿠???�존??, "value": 40 },
      { "op": "remove", "path": "/주인�??�이???�롯/박하?�탕" }
    ]
    </JSONPatch>
    </UpdateVariable>
    ```

?�치채셨?�요? AI 출력 결과?� ?�롬?�트??`format` 부분이 거의 **?��??�로 ?�??*?�다???�실?�요!
그래??�?���??�空??????[<u>**추�? 출력 ?�식**</u>](https://stagedog.github.io/%E9%9D%92%E7%A9%BA%E8%8E%89/%E5%B7%A5%E5%85%B7%E7%BB%8F%E9%AA%8C/%E6%8F%90%E7%A4%BA%E8%AF%8D%E4%B8%AA%E4%BA%BA%E5%86%99%E6%B3%95/%E9%A2%9D%E5%A4%96%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F/) ?�트???�말 ?�용?�답?�다.

변??출력 ?�식 ?�롬?�트가 ?�떻�??�성?�었?��? 차근차근 ?�펴봅시??
?�것?� ?�게 `rule`�?`format` ??부분으�??�뉩?�다.

* **`rule`?� 출력 규칙?�니??** AI?????�구?�항???�기�???�? 출력?��????�습?�다. ?�기??�?��리는 AI?�게 ?�음??지?�했?�니??
    * 변??출력 ?�식??출력?�어?????�치�?규정?�습?�다 (**?�장 ?��?�?*).
    * 출력???�데?�트 명령??**JSON Patch 규범**???�라???�을 강조?�습?�다. MVU??AI ?�장 ?�의 JSON Patch 명령???�석?�여 ?�제�?변?��? ?�데?�트?????�습?�다.

* **`format`?� 출력 ?�식?�니??** ???�에??�?��리는 AI가 ?�아?�을 ???�는 �?가지 ?�수 ?�식??채택?�여 ?�떻�?출력?�야 ?��? ?�술?�습?�다.
    * `${?�술}`: AI가 "?�술"??근거?�여 ?�당 ?�용???�?�하???�용?�로 ?�체해???�니??
        * ?�시: `?�상: ${캐릭?�의 ?�재 ?�상 구체???�술}` $\rightarrow$ `?�상: 분홍�?금색 ?�렁???�셔�??�옷`?�로 출력?????�음.
    * `$(?�구?�항)`: AI가 "?�구?�항"???�르기만 ?�고, ?��? ?�스?�로 출력?��? ?�습?�다.
        * ?�시: `$(?�하 ?�용?� ?�어�?출력??�?` $\rightarrow$ AI가 ?�후 ?�용???�어�?출력?�는 경향??보임.
    * `...`: AI가 ?�전??주어�?규칙�??�용??모방?�여 보충 출력?�야 ?�니??
        * ?�시: `기�? 캐릭?? ...` $\rightarrow$ AI가 ?�서 지?�된 **?�쿠??*??출력 ?�식??바탕?�로, ?�른 캐릭?�의 출력??보충??
    * 기�? ?�용?� ?�문 그�?�?출력?�니?? 그래??AI??`<UpdateVariable>`, `<Analysis>`, `<JSONPatch>` ?�의 ?�그�??�는 그�?�?출력?�습?�다.


?�제 방금 �??�롬?�트?� AI 출력 결과�??�시 ?�아보면, �????�이??관계�? ?�해?�시?�요?


=== "?�문 ?�롬?�트"
    ```yaml
    ?�量输出?�式:
      rule:
        - you must output the update analysis and the actual update commands at once in the end of the next reply
        - the update commands works like the **JSON Patch (RFC 6902)** standard, must be a valid JSON array containing operation objects, but supports the following operations instead:
          - replace: replace the value of existing paths
          - delta: update the value of existing number paths by a delta value
          - insert: insert new items into an object or array (using `-` as array index intends appending to the end)
          - remove
        - don't update field names starts with `_` as they are readonly, such as `_?�量`
      format: |-
        <UpdateVariable>
        <Analysis>$(IN ENGLISH, no more than 80 words)
        - ${calculate time passed: ...}
        - ${decide whether dramatic updates are allowed as it's in a special case or the time passed is more than usual: yes/no}
        - ${analyze every variable based on its corresponding `check`, according only to current reply instead of previous plots: ...}
        </Analysis>
        <JSONPatch>
        [
          { "op": "replace", "path": "${/path/to/variable}", "value": "${new_value}" },
          { "op": "delta", "path": "${/path/to/number/variable}", "value": "${positve_or_negative_delta}" },
          { "op": "insert", "path": "${/path/to/object/new_key}", "value": "${new_value}" },
          { "op": "insert", "path": "${/path/to/array/-}", "value": "${new_value}" },
          { "op": "remove", "path": "${/path/to/object/key}" },
          { "op": "remove", "path": "${/path/to/array/0}" },
          ...
        ]
        </JSONPatch>
        </UpdateVariable>
    ```

=== "?�국???�롬?�트"
    ```yaml
    변??출력 ?�식:
      rule:
        - ?�음 ?�장??�??�에 ?�데?�트 분석�??�제 ?�데?�트 명령????번에 출력?�야 ?�니??
        - ?�데?�트 명령?� **JSON Patch (RFC 6902)** ?��?�??�사?�게 ?�동?�며, ?�업 객체�??�함?�는 ?�효??JSON 배열?�어???�니?? ?? ?��? ?�???�음 ?�업??지?�합?�다:
          - replace: 기존 경로??변??�?교체
          - delta: 변??�?delta)???�용?�여 기존 ?�자 변?�의 �??�데?�트
          - insert: 객체??배열??????�� ?�입 (배열 ?�덱?�로 `-` ?�용 ???�에 추�?�??��?)
          - remove: ?�거
        - `_`�??�작?�는 ?�드 ?�름?� ?�기 ?�용?��?�??�데?�트?��? 마십?�오. (?? `_변??)
      format: |-
        <UpdateVariable>
        <Analysis>$(?�어�?출력, 80?�어 ?�하)
        - ${지???�간 계산: ...}
        - ${?�재 줄거리�? 충분???�수?��?, ?�간 경과가 ?�상 범위�??�씬 초과?�는지???�라 변??값의 극적??변???�용 ?��? ?�단: yes/no}
        - ${변?�에 ?�?�하??`check`�?기반?�로, ?�전 줄거리�? ?�닌 ?�재 ?�장?�만 근거?�여 �?변?�의 ?�데?�트 ?�요 ?��? 분석: ...}
        </Analysis>
        <JSONPatch>
        [
          { "op": "replace", "path": "${/변??경로}", "value": "${??�?" },
          { "op": "delta", "path": "${/?�자/변??경로}", "value": "${?�수_?�는_?�수??변?�값}" },
          { "op": "insert", "path": "${/객체/????경로}", "value": "${??�?" },
          { "op": "insert", "path": "${/배열/-}", "value": "${??�?" },
          { "op": "remove", "path": "${/객체/??경로}" },
          { "op": "remove", "path": "${/배열/0}" },
          ...
        ]
        </JSONPatch>
        </UpdateVariable>
    ```

=== "AI 출력 ?�시"
    ```xml
    ?�토�?부�?..

    <UpdateVariable>
    <Analysis>
    - Time advanced by 10 minutes (from 10:47 to 10:57) for the class break and the subsequent interaction.
    - Special Case? No, routine plot progression, no dramatic time skips.
    - ?�쿠???�존?? Baiya showed a strong reaction to Qingkong Li (trembling, calling him "brother", self-denial but accepting the candy secretly). She definitely noticed his attention and action. This indicates a significant emotional impact, warranting an increase.
    - ?�쿠??�?��: The "?�빠" slip-up and the immediate self-punishment reinforce her internal conflict, but doesn't necessarily grant a new title yet. Her current titles are still very relevant.
    - 주인�??�벤?�리: The mints were placed on Baiya's desk. The item should be removed from inventory.
    - ?�드.최근?�건: "?�학???�응" is ongoing but the specific interaction happened. "?�심?�간 ?�박" is becoming more relevant as break continues.
    </Analysis>
    <JSONPatch>
    [
      { "op": "replace", "path": "/?�드/?�재?�간", "value": "2024-04-08 10:57" },
      { "op": "replace", "path": "/?�쿠???�존??, "value": 40 },
      { "op": "remove", "path": "/주인�??�벤?�리/박하?�탕" }
    ]
    </JSONPatch>
    </UpdateVariable>
    ```


?�번?�는 **<span class="highlight-box">format</span>** 부분이 ?�떻�??�계?�었?��? ?�펴봅시??

<span class="highlight-box">format</span>??모든 출력 ?�용?� <span class="highlight-box">&lt;UpdateVariable&gt;</span> ?�그�?감싸???�습?�다. ?�는 �??�급?�게 ??"**?�번 ?�규??Tavern Regex)**" 처리�??�이?�게 ?�기 ?�함?�니??
�??�에??<span class="highlight-box">&lt;Analysis&gt;</span>?� <span class="highlight-box">&lt;JSONPatch&gt;</span> ??부분이 ?�어?�으�? 각각 **변???�데?�트???�??분석**�?**?�제 변??명령 출력**???�?�합?�다.

?�리??AI가 변???�데?�트???�??분석??먼�? 출력?�게 ?�고, �??�에 ?�제 변???�데?�트 명령??출력?�게 ?�니?? ?�처??AI가 먼�? "**초안???�성(?�草�?**"?????�식 ?�용??출력?�게 ?�는 방식??바로 **?�각???�슬(CoT)**???�형?�인 ?�용 ?��??�니??

!!! info "주의?�항"
    <span class="highlight-box">&lt;Analysis&gt;</span>가 바로 **?�각???�슬**?�며, ?�는 **변???�데?�트�??�해 ?�문?�된 ?�각???�슬**?�라???�을 기억?�세??
    변???�데?�트�??�해 별도???�각???�슬??추�??�야 ?�다�??�해?��? ?�도�?주의?�시�?바랍?�다.

<span class="highlight-box">&lt;Analysis&gt;</span> 부분에????가지 ?�고 ?�용???�함?�어 ?�는?? ?�는 �?���??�空??가 ?�주 ?�용?�는 방식?�로 ?� ??�� �??�용?�다�??�각?�는 것들?�니??

=== "?�문 ?�롬?�트"
    **?�토�??�간 변??계산**
    ```text
    - ${calculate time passed: ...}
    ```

    **?�토리에 ?�른 급격??변??변???�용**
    ```text
    - ${decide whether dramatic updates are allowed as it's in a special case or the time passed is more than usual: yes/no}
    ```

    **변???�데?�트???�요??[check]{.badge}�??�기?�고, ?�에 ?�라 ?�데?�트 방법 분석**
    ```text
    - ${analyze every variable based on its corresponding `check`, according only to current reply instead of previous plots: ...}
    ```

=== "?�국???�롬?�트"
    **?�토�??�간 변??계산**
    ```text
    - ${지???�간 계산: ...}
    ```

    **?�토리에 ?�른 급격??변??변???�용 (?? ?�감?��? 100?�서 0?�로 바로 ?�어�?**
    ```text
    - ${?�재 줄거리�? 충분???�수?��?, ?�간 경과가 ?�상 범위�??�씬 초과?�는지???�라 변??값의 극적??변???�용 ?��? ?�단: yes/no}
    ```

    **변???�데?�트???�요??[check]{.badge}�??�기?�고, ?�에 ?�라 ?�데?�트 방법 분석**
    ```text
    - ${변?�에 ?�?�하??`check`�?기반?�로, ?�전 줄거리�? ?�닌 ?�재 ?�장?�만 근거?�여 �?변?�의 ?�데?�트 ?�요 ?��? 분석: ...}
    ```


    그중 가??배울 만한 ?��? [변???�데?�트???�요??check�??�기?�고, ?�에 ?�라 ?�데?�트 방법 분석]{.badge}?�니??

?�리가 "변???�데?�트 규칙" ?�트?�서 ?�겨?�었??문제�?기억?�시?�요?
변???�데?�트 규칙?� 캐릭???�의 ?�전?�나 **D4**처럼 주의?�을 ??차�??�는 ?�치??배치?�여, AI가 ?�른 ?�롬?�트?� ?�토리에 ??집중?�게 만들 ???�습?�다. ?��?�?AI가 변???�데?�트 규칙??주의�???기울?�게 ?�면, 변?��? ?�데?�트?????�류가 발생?�기 ???�워집니??

변???�데?�트 규칙???�심?� [check]{.badge}?�니?? ?�것?� AI?�게 **무엇??근거�?변?��? ?�데?�트?�야 ?�는지, ?�떤 값으�??�데?�트?�야 ?�는지** ?�려줍니?? ?�리??변??출력 ?�식??`<Analysis>` 부분에??AI?�게 **?�각???�슬(CoT)**???�해 [check]{.badge}�??�기?�도�??�구?�습?�다. �? 변???�데?�트 규칙???�시 "**?�환(Recall)**"?�여 변???�데?�트�??�정?�하??것입?�다.

## ?�번 ?�규??(Tavern Regex)

변??출력 ?�식??갖추?�으므�? ?�제 AI???�장??????`<UpdateVariable>`??출력?�여 변?��? ?�데?�트??것입?�다. ?��?�???출력값�? 메시지 기록???�게 ?�며, ?�리가 별도�?처리?��? ?�으�??�후 ?�레?�할 ???�번(SillyTavern)?� 모든 메시지??`<UpdateVariable>`???�시 AI?�게 ?�송?�게 ?�니??

?��?�?분명??�? AI가 출력??`<UpdateVariable>`??**?�시 AI?�게 보낼 ?�요???�다**???�입?�다. `<UpdateVariable>` ?�의 ?�데?�트 명령?� ?��? MVU ?�크립트가 ?�석?�여 ?�용?�으�? AI가 ?�후 ?�장???�성????변???�데?�트 ?�식???�정?�하�??�해 ?�것??참고???�요??거의 ?�기 ?�문?�니?? (?�리???��? [?�드 ?�포]{.badge}??변??출력 ?�식???�공?�습?�다.)

만약 ?�리가 모든 메시지??`<UpdateVariable>`???�겨??AI?�게 보낸?�면:

* 첫째, **?�큰**????��?�니??
* ?�째, AI가 불필?�하�??�전??`<UpdateVariable>`???�습?�는 ??주의?�을 ??��?�여, **?�토리에 집중?�는 비중??줄어?????�습?�다.**
* 마�?막으�? AI가 게을?�져???�제�?변?��? ?�떻�??�데?�트?��? 분석?��? ?�고 **?�전??`<UpdateVariable>`??그�?�?베껴 ??가?�성**???�습?�다!

?�라???�리???�후 ?�성 ??`<UpdateVariable>` 부분을 AI?�게 보내지 ?�도�??�야 ?�니?? ?�때 ?�용?�는 것이 바로 **?�번 ?�규??*?�니??

?�번 ?�규?��? AI???�장�??�용?�의 ?�력 중에???�정 ?�스?��? ?�착?�여, ?�정 ?�도???�라 지?�된 ?�용?�로 치환??줍니??

* [?�롬?�트 ?�용 (Script Only)]{.badge}: AI?�게 ?�송???�만 지?�된 ?�용?�로 치환?�니??
* [GUI ?�용 (Display Only)]{.badge}: ?�번 ?�면???�시???�만 지?�된 ?�용?�로 치환?�니??
* **????체크 ?�제**: AI 출력???�신???�나 ?�용???�력???�송????**?�구?�으�?치환**?�니??

<p align="center">
  <img src="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/031a7caf-1590-41cd-9ca7-81ae99b945f7.jpg" width="400">
</p>

!!! tip "??
    만약 ?�의 ?�명?????�해?��? ?�는?�면, 본인???�번(SillyTavern)??기본 ?�함???�규???�트???�른 캐릭??카드???�함??미화???�규?�을 ?�펴보는 것도 좋�? 방법?�니??

?�러분의 ?�의�??�해, �?���??�空??가 `<UpdateVariable>` 변???�데?�트�?처리?�는 **?�번 ?�규??*??미리 만들???�었?�니?? ?�음 ??가지 버전 �??�나�??�택???�운로드?�여 가?�오�?Import)�??�면 ?�니??

* **미화??(Beautify)** ([<u>?�모 보기</u>](https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/%E7%BE%8E%E5%8C%96%E7%89%88.mp4)): <a href="../../assets/files/regex-remove-variable-update.json" download="regex-[不发???�除?�量?�新.json">`[?�송 ???? 변???�데?�트 ?�거`</a>, `[미화] 변???�데?�트 �?, `[미화] ?�체 변???�데?�트`
* **?�기??(Fold)** ([?�모 보기](https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/%E6%8A%98%E5%8F%A0%E7%89%88.mp4)): `[?�송 ???? 변???�데?�트 ?�거`, `[?�기] 변???�데?�트 �?, `[?�기] ?�체 변???�데?�트`
* **?�림??(Hint Only)** (?�용 ?�치�?불�?): `[?�송 ???? 변???�데?�트 ?�거`, `[?�림] 변???�데?�트 �?, `[?�림] ?�체 변???�데?�트`

?�기??�??�규?�의 ??��?� ?�음�?같습?�다.

* [변???�데?�트 ?�거]{.badge}???�규?�의 [?�롬?�트 ?�용 (Script Only)]{.badge} 기능???�용?�여, AI?�게 ?�송????`<UpdateVariable>` 부�??�체�?**공백?�로 치환**?�니??
* [변???�데?�트 �?{.badge}�?[?�체 변???�데?�트]{.badge}???�규?�의 [GUI ?�용 (Display Only)]{.badge} 기능???�용?�여, `<UpdateVariable>`???�시 방식???�쁘�?꾸며줍니?? ?��? ?�해 ?�레?�어???�데?�트 발생 ?��????????��?�? 구체?�으�?무엇???�데?�트?�었?��????�길 ???�습?�다.

---

?��?�? `변???�데?�트 ?�거`??기본?�으�?**모든 메시지**??`<UpdateVariable>`??AI?�게 보내지 ?�게 ?�정?�어 ?�습?�다. ?�로??**마�?�??�두 개의 메시지??AI?�게 보내?�록 ?�겨?�는 �?*??좋�? ?�택?????�습?�다.

만약 모든 메시지??`<UpdateVariable>`??AI?�게 보내지 ?�는?�면, AI??**모든 과거 줄거�?*�?참고??변?��? ?�데?�트?�야 ?�다�?착각?�여, **?��? 처리???�데?�트�?반복**?????�기 ?�문?�니??

> **?�시:**
> 지???�장?�서 AI가 "?�쿠?��? 주인공이 ?�이?�함"?�라??줄거리에 근거???��? **?�쿠?�의 ?�존??*�??�데?�트?�습?�다.
> ?��?�??�번 ?�장???�성?????�전??`<UpdateVariable>`(?�데?�트 기록)??�????�다�? AI??"?? ?�이?��? ?�네? ?�수 ?�려?��?!"?�고 ?�각?�고 ?�시 ?�번 ?�존?��? ?�릴 ???�습?�다.

만약 ?�렇�?줄거리에 근거??변?��? 중복 ?�데?�트?�는 ?�황??겪는?�면, **마�?�?1~2�?메시지??변???�데?�트 ?�역?� AI?�게 보내?�록 ?��?**?�는 ?�택???????�습?�다.

?��? 구현?�기 ?�해 ?�번 ?�규?�의 최소 깊이 기능???�용?????�습?�다. ??기능?� ?�규?�이 **최소???�정 ?�치 ?�상??깊이(?�래???�도)�?가�?메시지**?�만 ?�동?�도�??�한?�니??

```text
...
깊이 3: ?�에??4번째 메시지, 보통 AI???�장
깊이 2: ?�에??3번째 메시지, 보통 ?�용?�의 ?�력
깊이 1: ?�에??2번째 메시지, 보통 마�?�?AI???�장
깊이 0: ?�에??1번째 메시지, 보통 마�?�??�용?�의 ?�력
```

?�시 말해, 만약 ?�리가 [변???�데?�트 ?�거]{.badge}??최소 깊이(Min Depth)�?4�??�정?�다�? ???�규?��? ?�에??5번째 메시지 �?그보?????�래??메시지?�만 ?�효?�게 ?�니?? ?�렇�??�면 ?�리??마�?�??�두 번의 변???�데?�트 ?�황??AI?�게 ?�달?????�게 ?�는 것이�?

!!! failure "물론 ?�가???�릅?�다" ?�서 ?�급?�듯???�큰 ??��, 주의????��, 그리�?AI가 ?�제�?변?��? ?�떻�??�데?�트?��? 분석?�고 고�??�는 ?�???�전??<UpdateVariable>??그�?�?베껴 ?�는 게으름을 ?�울 가?�성???�깁?�다. ?��

변???�데?�트 강조
?�리가 D0(Author's Note ????변??출력 ?�식???�정???�더?�도, ?��? 모델?�나 ?�리?��? ?�전???�구?�항?��?<UpdateVariable>...</UpdateVariable>??출력?�여 변?��? ?�데?�트?��? ?�을 ???�습?�다.

만약 ?�런 ?�황??겪는?�면, �?���??�空??가 **추�? 출력 ?�식**?�서 ?�안?�던 것처?? D0??변??출력 ?�식??출력 ?�식 강조�?추�??????�습?�다.

```yaml
---
변??출력 ?�식 강조:
  rule: The following must be inserted to the end of reply, and cannot be omitted
  format: |-
    <UpdateVariable>
    ...
    </UpdateVariable>
```

# ?�로 ?�른 ?�프?�에 ?�로 ?�른 변??초기�??�정 (증분 방식)

?�서 **[?�로 ?�른 ?�프?�에 ?�로 ?�른 변??초기�??�정 (?�체 방식)](#)**?�서, ?�??`<initvar>...</initvar>` 블록???�용?�여 ?�프?�마???�른 변??초기값을 ?�정?�는 방법???�개?�습?�다.

?��?�???방법?� **�??�프?�마??변??초기�??�체�??�시 ?�성?�야 ?�다**???�점???�습?�다.
?��? ?�어, 분명 `[initvar]` ??���?**?�프??2**가 ?��? [좌절 모드 ?�위�?{.badge} ?�나�??�르?�라?? ?�리??**?�프??2**???�체 변??구조�??�같???�성?�야�??�습?�다.

=== "[initvar] ??��"
    ```yaml hl_lines="7"
    ?�라카�? �?
      ?�감?? 25
      고독�? 60
      ?�인 관�? false
      ?�망: false
      좌절 ?�나리오 ?�위�? false
    ```

=== "?�프??2"
    ```yaml hl_lines="11"
    ?�프??2 ?�토�?..

    <UpdateVariable>
    <initvar>
    ```yaml
    ?�라카�? �?
      ?�감?? 25
      고독�? 60
      ?�인 관�? false
      ?�망: false
      좌절 ?�나리오 ?�위�? true
    ```
    </initvar>
    </UpdateVariable>
    ```

?�무 번거�?��! ?�떨 ?�는 그�? 변???�두 개만 바꾸�??�을 뿐인??말이�? (qwq)

......`<initvar>...</initvar>` 블록???�용?�여 ?�프?�에??변??초기값을 ?�전???�로 ?�정?�는 방법 ?�에?? ?�리??`[initvar]` ??��???�정??**변??초기값을 부분적?�로 ?�정**???�도 ?�습?�다.

?��? ?�해?�는 **변??출력 ?�식**???�떻�??�용?�는지 ?�시 ?�번 ?�해???�요가 ?�습?�다.

* AI??변??출력 ?�식???�라, ?�선 **변???�데?�트???�??분석**??출력???? **?�제 변???�데?�트 명령**??출력?�니??
* MVU??메시지 ?�의 변???�데?�트 명령???�고, ?�?�하??변?��? ?�데?�트?�니??
* ???�데?�트 과정?� **모든 메시지(Floor)**?�서 진행?�니??
    `[initvar]` ?�정�?$\rightarrow$ `0�?메시지` ?�데?�트 ??�?$\rightarrow$ `1�?메시지` ?�데?�트 ??�?$\rightarrow$ ...
* �?메시지???�신??변??값을 ?�?�합?�다. ?�라??[?�번 ?�력�??�쪽 ?�술�???변??관리자 ??메시지(Message Floor)]{.badge}?�서 �?메시지(�???변??값을 ?�인?????�으�? 메시지�???��????변???�한 ?�상?�으�??�돌?�집?�다.

?�시 ?�번 강조?�자�? **"???�데?�트 과정?� 모든 메시지?�서 진행?�니??**.
맞습?�다! **?�프??메시지(0�?메시지)**?�서??변???�데?�트 명령???�용?�여 변?��? 갱신?????�습?�다!

```json hl_lines="6"
?�프??2 ?�토�?..

<UpdateVariable>
<JSONPatch>
[
  { "op": "replace", "path": "/?�라카�? �?좌절 ?�나리오 ?�위�?, "value": true }
]
</JSONPatch>
</UpdateVariable>
```

?��?�?<JSONPatch> 부분이 ?�무 복잡??보이?�요? 걱정 마세?? ?�리?�겐 ?��? 변??출력 ?�식???�습?�다. ?�프???�토리�? AI?�게 보내?? AI가 ?�아???�?�하??변???�데?�트 명령???�성?�게 ?�키�??�니??

## ??가지 변???�데?�트 방식 지??

AI가 줄거�??�토�???집중?????�도�? MVU???�레?�어가 ?�유�?�� ?�택?????�는 **??가지 변???�데?�트 방식**??지?�합?�다.

* **[AI 출력???�함 (Along with AI Output)]{.badge}**: AI가 줄거리�? 먼�? 출력???? ?�어??변???�데?�트 명령??출력?�니??
* **[추�? 모델 ?�석 (Extra Model Analysis)]{.badge}**: ?�나??AI가 ?�문?�으�?줄거리�? 출력?�고, ???�른 별개??AI가 �?줄거리�? ?�석?�여 변???�데?�트 명령???�문?�으�?출력?�니??

<p align="center">
  <img src="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/e69caa1a-05de-48ec-a595-92e743bf20ac.jpg" width="400">
</p>

만약 ?�러분이 '문의 주인 카드 ?�성 ?�우�??�之主写?�助??'�??�해 3?� 변???�롬?�트�??�성?�다�? ?�성????��???�름??`변??목록`, `[mvu_update]변???�데?�트 규칙`, `[mvu_update]변??출력 ?�식`??것을 ?�치채셨??겁니??

`[mvu_update]`?�는 ?�두?�는 ?�실 ??**??가지 변???�데?�트 방식**??모두 지?�하�??�해 존재?�는 것입?�다.

* **[AI 출력???�함]{.badge} 방식:** 모든 ??��???�상?�으�?AI?�게 ?�송?�니??
* **[추�? 모델 ?�석]{.badge} 방식:**
    * ?�름??`[mvu_plot]`???�함????��?� **줄거�??�당 AI**?�게�??�송?�니??
    * ?�름??`[mvu_update]`가 ?�함????��?� **변???�데?�트 ?�당 AI**?�게�??�송?�니?? (그렇�??�문??[변???�데?�트 규칙]{.badge}�?[변??출력 ?�식]{.badge} ?�에 `[mvu_update]`가 붙�? 것입?�다.)
    * ?�름??`[mvu_plot]`�?`[mvu_update]`가 모두 ?�는 ??��?� **??AI 모두?�게** ?�송?�니??

�? 만약 ?�러분이 ???�토리얼???�라 `변??목록`, `[mvu_update]변???�데?�트 규칙`, `[mvu_update]변??출력 ?�식`?�로 변???�롬?�트�??�성?�다�? **?�신??캐릭??카드???��? ??가지 변???�데?�트 방식??모두 지??*?�는 ?�태?�니??

!!! tip "??
    ?�레?�어로서 게임?????? `[mvu_update]` ?�는 `[mvu_plot]`???�름???�함????��???��? **?�역 ?�드 ?�포(Global World Info)**�??�성?�하?? 줄거�?AI?� 변???�데?�트 AI???�동???�어???�도 ?�습?�다.

    ?��? ?�어, `[mvu_update]` D9999 ??��???�용?�여 **변???�데?�트 AI?�게 ?�옥 ?�롬?�트�?추�?**?????�습?�다.

변???�롬?�트??그�? ?�롬?�트??뿐입?�다

변??목록?�든, 변???�데?�트 규칙?�든, ?��? 변??출력 ?�식?�든 간에, ?�것?��? 모두 ?�리가 [?�드 ?�포]{.badge}???�성???�는 **?�롬?�트??불과**?�니??
?�의 ?�토리얼?�서 ?�??**'문의 주인 카드 ?�성 ?�우�??�之主写?�助??'**가 ?�용?�는 버전???�시�??�었지�? ?�러분�? ?�마?��? **?�신만의 ?�트**�?직접 ?�계?????�습?�다!

?�한, ?�떤 변?�들?� **?�정 ?�황?�서�?* ?�요???�도 ?�습?�다.
?��? ?�어 만약 **?�무 ?�스??Task System)**???�정 캐릭?��?�?묶여 ?�다�? ?�연???�리???�당 캐릭?��? ?�장???�만 ?�무 ?�스??관???�롬?�트�??�송?�면 ??것입?�다.

?�라??`{{format_message_variable::stat_data}}`�??�용?�여 뭉뚱그려 보내???�?? ?�음�?같이 ?�누???�성?????�습?�다.

```yaml
---
<status_current_variable>
캐릭??
  {{format_message_variable::stat_data.캐릭??}
# ⬇️⬇️⬇️⬇️⬇️ 초록�?Green Light)?�나 추후 ?�개??기능???�용?�여,
# ?�리???�정 ?�황?�서�??�래 ?�롬?�트�??�송?�도�??�정?????�습?�다.
?�무 ?�스??
  {{format_message_variable::stat_data.?�무?�스??}
# ⬆️⬆️⬆️⬆️⬆️
</status_current_variable>
```

?�무 ?�스?�의 변???�데?�트 규칙 ?�한 ?�일??방식?�로 처리?????�습?�다.

변???�롬?�트 ?�스??

?�제 변???�롬?�트가 준비되?�습?�다. **MVU 변???�레?�워??* ?�정?�서 [변???�데?�트 ?�류 ???�림]{.badge}??체크?�세??
그다??**변??관리자**�??�어 ?�쪽???�고, AI?�게 ?�무 말이???? `[?�토�?진행]`){.badge} 보내??AI가 줄거리�? 진행?�게 ???? 메시지(Message Floor)??`<UpdateVariable>` 블록???�바르게 출력?�는지 ?�인??보세??

<p align="center">
  <img src="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/3dc6d008-444b-4809-8fc1-37d8b6f40feb.jpg" width="400">
</p>

### 문제 ?�결 가?�드

!!! failure "<UpdateVariable> 블록??출력?��? ?�는 경우"
    ?�른 ?�롬?�트가 주의??Attention)???�무 많이 차�??�고 ?�거?? 변???�롬?�트가 ?�바르게 ?�용?��? ?�았??가?�성???�습?�다.

    1. **?�역 ?�드 ?�포(Global World Info)**�?비활?�화??보세??
    2. ?�른 ?�롬?�트??주의?�을 조정???? �?챕터???�용?��?변???�롬?�트가 ?�확???�정?�었?��? 검증하?�요.

!!! warning "?��????�러 발생: `[MVU]?�生?�量?�新?��?`"
    만약 `[MVU zod]`가 ?�닌 `[MVU] 변???�데?�트 ?�류 발생([MVU]?�生?�量?�新?��?)`?�라???��????�러가 ?�다�? ?�는 **변??구조 ?�크립트**???�류가 ?�다???�입?�다.

    **?�결 방법:**
    1. 변??구조 ?�크립트�?껐다 켜보?�요.
    2. 로그�??�인?�여 **빨간???�러**가 ?�는지 찾아보세??
        * **PC:** `[F12 ??콘솔 (devtool)]{.badge}`
        * **모바??** `[?�력�?좌측 ?�단 ?�술�???로그 뷰어 (Log Viewer)]{.badge}`
    3. 빨간???�러가 ?�다�?�??�용??복사?�서 AI?�게 보내 **변??구조 ?�크립트�??�시 ?�성**?�게 ?�키?�요. (?�러가 ?�더?�도 그냥 ?�시 ?�성?�게 ?�켜???�니??)
    4. ?��????�결?��? ?�는?�면 ?�럼 ?�을 ?�해 ?�작??�?���? qwq)?�게 문의?�세??

!!! success "?�스???�공"
    ?�의 문제가 발생?��? ?�았?�면, ?�반?�으�?변???�롬?�트가 ?�상?�으�??�동?�고 ?�는 것입?�다!
    변?��? ?�데?�트????변??관리자?�서 ?�이?�이???�니메이?�이 ?�생?�고, ?�데?�트???�롬?�트 ?�용???�시??것입?�다.


## ?�돌?�보�?

?�로???�리??변???�경 구축???�료?�었?�니??

* ?�리??**변??구조 ?�크립트**�??�성?�고 ?�로 만들?�으�? ?�는 ?�리 캐릭??카드???�떤 변?��? ?�는지 ?�의?�습?�다.
* ?�리??`[initvar]변??초기???�성??금�?` ??���??�프?�의 `<initvar>` 블록???�용?�여 �??�프?�마??초기값을 ?�정?�습?�다.
* ?�리??AI가 변?��? ?�해?????�도�?**변???�롬?�트**�??�계?�습?�다.
    * **변??목록**???�해 ?�재??변???�황???�악?�습?�다.
    * **변???�데?�트 규칙**???�해 변?��? ?�떤 ?�황?�서 ?�데?�트?�어???�는지, 그리�??�떤 값으�??�데?�트?�어???�는지 ?�악?�습?�다.
    * **변??출력 ?�식**???�해 변?��? ?�데?�트?�기 ?�해 무엇??출력?�야 ?�는지 ?�악?�습?�다.
* **?�번 ?�규??* ?�트�?가?��??? ?�전??`<UpdateVariable>` 블록???�시 AI?�게 ?�송?��? ?�도�??�여 **AI 과적??Overfitting)**??방�??�습?�다.

???�경?� 매번 모든 ?�스?��? ?�체 출력?�야 ?�던 기존???�통?�인 ?�태창을 ?�과?�으�??�체하�? AI?�게 ?�재???�토�??�태�??�확?�게 ?�기?�켜 �????�습?�다!

?�—하지�?변?��? ?????�는 �??�뿐만이 ?�닙?�다.

?�서 ?�급?�듯?? `?�쿠???�존????경우 AI가 ?�름�?보고???�것???�쿠?�의 주인공에 ?�???�착 ?�도?�는 것�? ?????�습?�다. ?��?�?**23**�?같�? 구체?�인 ?�치?�서, ?�쿠?�는 ?�떤 ?�리 ?�태?�야 ?�까?? ?�떤 ?�동??취하???�까?? ?�런 것들?� ?�리??추�??�인 ?�석???�요?�니??

?�시 ?�리???�택?� **캐릭???�계** ??��???�로 만들?? �??�존???�계�??�쿠?�의 ?�동???�열?�는 것이?�습?�다.

```yaml
?�쿠?�의 ?�재 ?�동: # ?�쿠?�의 ?�재 ?�존?�는 {{format_message_variable::stat_data.?�쿠???�존??}?��?�? ?�음 ?�시?� ?�사???�동??취하??경향???�음
  # 0~19 ????
  ?�극???�기 ?�괴:
    ...
  # 20~39 ????
  관??갈구:
    ...
  # 40~59 ????
  ?�밀???�근:
    ...
  # 60~79 ????
  불안???�존:
  # 80~100 ????
  ?�순???�존:
    ...

```

?��?�???방식?�는 명백??문제가 ?�습?�다. 비록 ?�재 ?�쿠?�의 ?�존?�는 23?��?�? ?�리???�전??0~19, 40~59 ???�른 ?�계???�롬?�트까�? 모두 ?�송?�고 ?�습?�다.

?�는 ?�력 ?�큰????��??뿐만 ?�니?? AI??주의?�을 불필?�하�?차�??�여, AI가 ?�쿠?�에�??�느 ?�계???�동??취하�??�야 ?��? ?��??�럽�?만들 ???�습?�다.

만약 ?�재 ?�존?�에 근거?�여, ?�재 ?�존?�에 ?�?�하???�롬?�트�??�송?????�다�??�마??좋을까요! 만약 ?�존?��? 100???�달?�을 ?? 미리 ?�성????고백 ?�벤?��? ?�리거할 ???�다�??�마??좋을까요!

......물론, ?�리???????�습?�다?�� ?�음 ?�이지?�서 ?�인?�세??
