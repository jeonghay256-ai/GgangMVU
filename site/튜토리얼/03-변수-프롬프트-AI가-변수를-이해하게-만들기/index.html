<!DOCTYPE html><html lang="ko" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="MVU Zod 플러그인 사용법을 위한 한국어 가이드">
      
      
      
        <link rel="canonical" href="https://example.github.io/mvu-zod-guide/%ED%8A%9C%ED%86%A0%EB%A6%AC%EC%96%BC/03-%EB%B3%80%EC%88%98-%ED%94%84%EB%A1%AC%ED%94%84%ED%8A%B8-AI%EA%B0%80-%EB%B3%80%EC%88%98%EB%A5%BC-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B2%8C-%EB%A7%8C%EB%93%A4%EA%B8%B0/">
      
      
        <link rel="prev" href="../02-%EB%B3%80%EC%88%98-%EC%84%A4%EC%A0%95/">
      
      
        <link rel="next" href="../04-%ED%94%84%EB%A1%AC%ED%94%84%ED%8A%B8-%ED%85%9C%ED%94%8C%EB%A6%BF-%ED%94%84%EB%A1%AC%ED%94%84%ED%8A%B8%EB%A5%BC-%EB%8F%99%EC%A0%81%EC%9C%BC%EB%A1%9C-%EC%A0%84%EC%86%A1/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>변수 프롬프트 - AI가 변수를 이해하게 만들기 - MVU Zod 한국어 가이드</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Noto Sans KR";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ai" class="md-skip">
          콘텐츠로 이동
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="상단/헤더">
    <a href="../.." title="MVU Zod 한국어 가이드" class="md-header__button md-logo" aria-label="MVU Zod 한국어 가이드" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MVU Zod 한국어 가이드
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              변수 프롬프트 - AI가 변수를 이해하게 만들기
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom" aria-label="다크 모드로 전환" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="다크 모드로 전환" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom" aria-label="라이트 모드로 전환" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="라이트 모드로 전환" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="검색" placeholder="검색" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="검색">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="공유" aria-label="공유" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="지우기" aria-label="지우기" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            검색 초기화
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="네비게이션" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MVU Zod 한국어 가이드" class="md-nav__button md-logo" aria-label="MVU Zod 한국어 가이드" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    MVU Zod 한국어 가이드
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    홈
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    튜토리얼
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    튜토리얼
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-%ED%94%8C%EB%9F%AC%EA%B7%B8%EC%9D%B8-%EC%84%A4%EC%B9%98/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    플러그인 설치
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-%EB%B3%80%EC%88%98-%EC%84%A4%EC%A0%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    변수 설정
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    변수 프롬프트 - AI가 변수를 이해하게 만들기
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    변수 프롬프트 - AI가 변수를 이해하게 만들기
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="목차">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      목차
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수의 3가지 핵심 정보
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        간단하게 3대 변수 프롬프트 만들기
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 목록
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="변수 목록">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tavernhelper-format_message_variable" class="md-nav__link">
    <span class="md-ellipsis">
      
        TavernHelper 매크로 {{format_message_variable::변수}}
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ai_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        AI가 변수 목록의 값이 '최신'임을 알게 하기
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 의미 구체적으로 설명하기
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 업데이트 규칙
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="변수 업데이트 규칙">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        각 항목의 의미
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 업데이트 규칙 중복 작성 피하기
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 구조를 변수 업데이트 규칙으로 직접 사용하기
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 업데이트 규칙의 삽입 위치
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 출력 형식
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 출력 형식
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="변수 출력 형식">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      
        해설
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cot" class="md-nav__link">
    <span class="md-ellipsis">
      
        CoT(생각의 사슬) 단계별 상세
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sillytavern" class="md-nav__link">
    <span class="md-ellipsis">
      
        SillyTavern 정규식
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 업데이트 강조
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      
        다른 오프닝에 다른 변수 초기값 설정하기 (증분 방식)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      
        두 가지 변수 업데이트 방식 지원
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 프롬프트는 단지 프롬프트일 뿐
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-%ED%94%84%EB%A1%AC%ED%94%84%ED%8A%B8-%ED%85%9C%ED%94%8C%EB%A6%BF-%ED%94%84%EB%A1%AC%ED%94%84%ED%8A%B8%EB%A5%BC-%EB%8F%99%EC%A0%81%EC%9C%BC%EB%A1%9C-%EC%A0%84%EC%86%A1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    프롬프트 템플릿 - 프롬프트를 동적으로 전송
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-TavernHelper-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EB%B0%B1%EA%B7%B8%EB%9D%BC%EC%9A%B4%EB%93%9C-%EC%A0%9C%EC%96%B4-%EB%B0%8F-%EB%B3%80%EC%88%98-%ED%99%9C%EC%9A%A9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TavernHelper 스크립트 - 백그라운드 제어 및 변수 활용
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-%EC%83%81%ED%83%9C%EB%B0%94/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    상태바
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-%EB%B3%80%EC%88%98-%EA%B5%AC%EC%A1%B0-%EC%9E%91%EC%84%B1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    변수 구조 작성
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-%EA%B8%B0%EC%A1%B4-MVU-%EB%A7%88%EC%9D%B4%EA%B7%B8%EB%A0%88%EC%9D%B4%EC%85%98/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    기존 MVU 마이그레이션
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-%EC%9E%91%EC%84%B1-%ED%85%9C%ED%94%8C%EB%A6%BF-%EC%82%AC%EC%9A%A9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    작성 템플릿 사용
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-MVU%EA%B0%80-AI%EB%A5%BC-%EB%B0%94%EB%B3%B4%EB%A1%9C-%EB%A7%8C%EB%93%9C%EB%82%98/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MVU가 AI를 바보로 만드나
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11-%EC%A7%88%EB%AC%B8%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    질문하는 방법
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="목차">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      목차
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수의 3가지 핵심 정보
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        간단하게 3대 변수 프롬프트 만들기
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 목록
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="변수 목록">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tavernhelper-format_message_variable" class="md-nav__link">
    <span class="md-ellipsis">
      
        TavernHelper 매크로 {{format_message_variable::변수}}
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ai_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        AI가 변수 목록의 값이 '최신'임을 알게 하기
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 의미 구체적으로 설명하기
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 업데이트 규칙
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="변수 업데이트 규칙">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        각 항목의 의미
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 업데이트 규칙 중복 작성 피하기
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 구조를 변수 업데이트 규칙으로 직접 사용하기
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 업데이트 규칙의 삽입 위치
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 출력 형식
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 출력 형식
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="변수 출력 형식">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      
        해설
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cot" class="md-nav__link">
    <span class="md-ellipsis">
      
        CoT(생각의 사슬) 단계별 상세
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sillytavern" class="md-nav__link">
    <span class="md-ellipsis">
      
        SillyTavern 정규식
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 업데이트 강조
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      
        다른 오프닝에 다른 변수 초기값 설정하기 (증분 방식)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      
        두 가지 변수 업데이트 방식 지원
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      
        변수 프롬프트는 단지 프롬프트일 뿐
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="ai">변수 프롬프트: AI가 변수를 이해하게 만들기<a class="headerlink" href="#ai" title="Permanent link">¶</a></h1>
<p>이전 장에서 우리는 변수를 성공적으로 설정하고 초기화했습니다. 하지만 이것은 단지 Tavern 차원에서 캐릭터 카드에 변수를 설정한 것일 뿐, 아직 AI에게 "이런 변수가 있다"고 알려주지는 않은 상태입니다. 비유하자면 이렇습니다: 캐릭터 카드에는 보통 프로필 사진이 있지만, AI에게 물어보면 당신이 캐릭터 카드에 어떤 사진을 설정했는지 전혀 모르는 것과 같습니다.</p>
<p>그렇다면, 어떻게 해야 AI가 이 변수들을 "보고" 우리의 의도대로 조작하게 만들 수 있을까요? 바로 월드 인포(World Info)에 <strong>프롬프트</strong>를 작성해서, AI에게 변수에 대한 <strong>3가지 핵심 정보</strong>를 알려줘야 합니다.</p>
<h2 id="3">변수의 3가지 핵심 정보<a class="headerlink" href="#3" title="Permanent link">¶</a></h2>
<p><strong>변수 목록 (Variable List)</strong>
* 현재 변수의 값은 얼마이며, 그 값은 어떤 의미인가?
* <em>예시:</em> <code>하쿠아.의존도</code>라는 변수의 현재 수치는 얼마인가? 0일 때와 100일 때는 각각 무슨 의미인가?</p>
<p><strong>변수 업데이트 규칙 (Variable Update Rules)</strong>
* 변수는 어떤 상황에서 업데이트되어야 하며, 어떤 값으로 변해야 하는가?
* <em>예시:</em> <code>하쿠아.의존도</code>라는 변수는 어떤 스토리 상황에서 상승해야 하고, 반대로 어떤 상황에서 하락해야 하는가?</p>
<p><strong>변수 출력 형식 (Variable Output Format)</strong>
* AI가 변수를 업데이트하기 위해 무엇을 출력해야 하는가?
* <em>예시:</em> AI가 "하쿠아와 주인공이 함께 데이트를 갔으니 <code>하쿠아.의존도</code>가 20에서 25로 상승해야 한다"고 판단했다면, MVU 스크립트에게 <code>하쿠아.의존도</code>를 25로 업데이트하라고 알리기 위해 무엇을 출력해야 하는가?</p>
<p>……아직 안 헷갈리셨죠? 다른 비유를 들어볼게요! 만약 AI가 스토리 전개에 따라 캐릭터 카드의 프로필 사진을 직접 수정할 수 있게 만든다고 가정해 봅시다:</p>
<p><strong>변수 목록</strong>
캐릭터 카드의 현재 프로필 사진은 무엇인가? 그것은 어떤 의미인가?</p>
<p><strong>변수 업데이트 규칙</strong>
캐릭터 카드의 프로필 사진은 어떤 상황에서 업데이트되어야 하며, 어떤 사진으로 바꿔야 하는가?</p>
<p><strong>변수 출력 형식</strong>
AI가 프로필 사진을 업데이트하기 위해 무엇을 출력해야 하는가? 아마도 직접 이미지를 출력하면 되겠죠! 그러면 어떤 프로필 사진 교체 스크립트가 이 이미지를 읽어서 새로운 캐릭터 카드 프로필 사진으로 설정할 것입니다.</p>
<hr>
<h2 id="3_1">간단하게 3대 변수 프롬프트 만들기<a class="headerlink" href="#3_1" title="Permanent link">¶</a></h2>
<p>거의 생각 없이도 변수 목록, 변수 업데이트 규칙, 변수 출력 형식을 얻을 수 있습니다:</p>
<p><strong><code>[mvu_update]변수 업데이트 규칙</code></strong>
이전에 <code>변수 구조 설계</code>를 생성할 때 사용했던 채팅을 이어서, 문지기(Gatekeeper) 카드 작성 도우미의 <code>변수 업데이트 규칙</code> 항목으로 전환합니다. 강조하고 싶은 업데이트 규칙(예: <code>백아의 칭호는 반드시 백아가 주인공에 대해 가지는 태도를 반영해야 함</code>)을 입력한 후 AI에게 생성하게 하고, 마지막으로 생성 결과를 직접 조정하면 됩니다.</p>
<p><strong><code>[mvu_update]변수 출력 형식</code>과 <code>변수 목록</code></strong>
<a href="https://github.com/StageDog/tavern_helper_template/blob/main/%E5%88%9D%E5%A7%8B%E6%A8%A1%E6%9D%BF/%E8%A7%92%E8%89%B2%E5%8D%A1/%E6%96%B0%E5%BB%BA%E4%B8%BAsrc%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%AD%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B9/%E4%B8%96%E7%95%8C%E4%B9%A6/%E5%8F%98%E9%87%8F/%5Bmvu_update%5D%E5%8F%98%E9%87%8F%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F.md">[mvu_update]변수 출력 형식</a>과 <a href="https://github.com/StageDog/tavern_helper_template/blob/main/%E5%88%9D%E5%A7%8B%E6%A8%A1%E6%9D%BF/%E8%A7%92%E8%89%B2%E5%8D%A1/%E6%96%B0%E5%BB%BA%E4%B8%BAsrc%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%AD%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B9/%E4%B8%96%E7%95%8C%E4%B9%A6/%E5%8F%98%E9%87%8F/%E5%8F%98%E9%87%8F%E5%88%97%E8%A1%A8.md">변수 목록</a>의 내용을 직접 복사하면 됩니다.</p>
<p>이렇게 해서 우리는 3대 변수 프롬프트 항목을 갖게 되었습니다. 아래 그림처럼 설정하면, AI가 변수를 이해하고 업데이트할 수 있게 됩니다:</p>
<p align="center">
  <a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/93f79570-1e89-454d-b3e2-944d60f30248.png" data-desc-position="bottom"><img src="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/93f79570-1e89-454d-b3e2-944d60f30248.png" width="400"></a>
</p>

<p>그런 다음, <strong>SillyTavern 우측 상단의 블록 버튼(확장 기능) ‣ 정규식(Regex)</strong>으로 이동하여, 다음 버전 중 하나의 정규식 3개를 로컬 정규식에 가져옵니다:</p>
<ul>
<li><strong>미화 버전</strong> (<a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/%E7%BE%8E%E5%8C%96%E7%89%88.mp4">데모 보기</a>): <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E4%B8%8D%E5%8F%91%E9%80%81]%E5%8E%BB%E9%99%A4%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0.json?inline=false">[미전송]변수 업데이트 제거</a>, <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E7%BE%8E%E5%8C%96]%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0%E4%B8%AD.json?inline=false">[미화]변수 업데이트 중</a>, <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E7%BE%8E%E5%8C%96]%E5%AE%8C%E6%95%B4%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0.json?inline=false">[미화]전체 변수 업데이트</a></li>
<li><strong>접기 버전</strong> (<a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/%E6%8A%98%E5%8F%A0%E7%89%88.mp4">데모 보기</a>): <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E4%B8%8D%E5%8F%91%E9%80%81]%E5%8E%BB%E9%99%A4%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0.json?inline=false">[미전송]변수 업데이트 제거</a>, <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E6%8A%98%E5%8F%A0]%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0%E4%B8%AD.json?inline=false">[접기]변수 업데이트 중</a>, <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E6%8A%98%E5%8F%A0]%E5%AE%8C%E6%95%B4%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0.json?inline=false">[접기]전체 변수 업데이트</a></li>
<li><strong>힌트만 버전</strong> (펼쳐서 내용 확인 불가): <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E4%B8%8D%E5%8F%91%E9%80%81]%E5%8E%BB%E9%99%A4%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0.json?inline=false">[미전송]변수 업데이트 제거</a>, <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E6%8F%90%E7%A4%BA]%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0%E4%B8%AD.json?inline=false">[힌트]변수 업데이트 중</a>, <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E6%8F%90%E7%A4%BA]%E5%AE%8C%E6%95%B4%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0.json?inline=false">[힌트]전체 변수 업데이트</a></li>
</ul>
<p>이렇게 하면 변수 프롬프트 작성이 완료되어 다음 장으로 넘어갈 수 있습니다! 하지만 각 프롬프트가 정확히 어떤 역할을 하고 어떻게 작동하는지 이해해보는 것을 추천합니다:</p>
<hr>
<h2 id="_1">변수 목록<a class="headerlink" href="#_1" title="Permanent link">¶</a></h2>
<p>변수 목록은 AI에게 <strong>변수의 현재 값이 무엇인지</strong>, 그리고 <strong>변수가 어떤 의미인지</strong> 알려줍니다.</p>
<p>하지만 문지기(Gatekeeper) 카드 작성 도우미의 변수 목록 프롬프트는 매우 간단하게 작성되어 있습니다:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>---
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>&lt;status_current_variable&gt;
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>{{format_message_variable::stat_data}}
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>&lt;/status_current_variable&gt;
</code></pre></div>
<p>이것만으로 어떻게 AI가 변수의 현재 값과 의미를 알 수 있을까요?</p>
<p>그 이유는 실제로 전송될 때, <code>{{format_message_variable::stat_data}}</code>가 그대로 전송되는 것이 아니라 <strong>실제 변수 내용으로 대체</strong>되기 때문입니다:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"><input id="__tabbed_1_2" name="__tabbed_1" type="radio"><input id="__tabbed_1_3" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1">프롬프트</label><label for="__tabbed_1_2">AI에게 전송되는 결과</label><label for="__tabbed_1_3">프롬프트 뷰어</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>---
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>&lt;status_current_variable&gt;
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>{{format_message_variable::stat_data}}
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>&lt;/status_current_variable&gt;
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nn">---</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="l l-Scalar l-Scalar-Plain">&lt;status_current_variable&gt;</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="l l-Scalar l-Scalar-Plain">세계</span><span class="p p-Indicator">:</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">  </span><span class="nt">현재시간</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2024-04-08 10:45</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">  </span><span class="nt">현재장소</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">사립 카자마츠리 학원 고등부 2학년 A반 교실</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">  </span><span class="nt">최근사건</span><span class="p">:</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">    </span><span class="nt">전학생_배치</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">하쿠아가 막 전학 왔으며, 교재 수령 및 캠퍼스 환경 익히기 필요</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">    </span><span class="nt">좌석_조정</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">반장이 최종 좌석표를 확인 중이며, 약간의 조정이 있을 수 있음</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">    </span><span class="nt">점심시간_임박</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">아직 한 수업이 남았지만 곧 점심시간이며, 하쿠아에게 접근할 기회</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="nt">하쿠아</span><span class="p">:</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">  </span><span class="nt">의존도</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">35</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">  </span><span class="nt">복장</span><span class="p">:</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">    </span><span class="nt">상의</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">깔끔한 진남색 교복 재킷, 단추 하나하나 빈틈없이 잠김</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="w">    </span><span class="nt">하의</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">단정한 진남색 플리츠 스커트, 길이는 딱 무릎까지</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="w">    </span><span class="nt">속옷</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">흰색 속옷 세트</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="w">    </span><span class="nt">양말</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">검은색 무릎 위 양말, 주름 하나 없음</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="w">    </span><span class="nt">신발</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">검은색 가죽 학생화, 반짝반짝 윤이 남</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="w">    </span><span class="nt">장신구</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">없음</span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="w">  </span><span class="nt">칭호</span><span class="p">:</span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="w">    </span><span class="nt">행시(行屍)</span><span class="p">:</span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="w">      </span><span class="nt">효과</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">일상 행동에 뚜렷한 나른함과 기계적인 느낌이 있음</span>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="w">      </span><span class="nt">자기평가</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">살아있는 것 자체가 벌이다</span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="w">    </span><span class="nt">도피자</span><span class="p">:</span>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="w">      </span><span class="nt">효과</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">청공리(아오조라 리)로부터 오는 어떤 접촉에도 본능적으로 회피함</span>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="w">      </span><span class="nt">자기평가</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">나는 그의 삶에 나타날 자격이 없어</span>
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a><span class="nt">주인공</span><span class="p">:</span>
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span class="w">  </span><span class="nt">아이템란</span><span class="p">:</span>
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a><span class="w">    </span><span class="nt">낡은_반창고</span><span class="p">:</span>
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a><span class="w">      </span><span class="nt">설명</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">지갑 안쪽에 2년간 넣어둔 캐릭터 반창고, 접착력은 아마 이미 없어졌을 것</span>
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a><span class="w">      </span><span class="nt">수량</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span class="w">    </span><span class="nt">박하사탕</span><span class="p">:</span>
<a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a><span class="w">      </span><span class="nt">설명</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">정신 차리기용 강력한 박하사탕, 예전에 그녀는 이 맛을 매우 싫어했음</span>
<a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a><span class="w">      </span><span class="nt">수량</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a><span class="l l-Scalar l-Scalar-Plain">&lt;/status_current_variable&gt;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>프롬프트 뷰어를 사용하면 실제로 AI에게 전송되는 내용을 확인할 수 있습니다.</p>
<p></p><p align="center">
  <a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="https://stagedog.github.io/_images/%E6%8F%90%E7%A4%BA%E8%AF%8D%E6%9F%A5%E7%9C%8B%E5%99%A8.png" data-desc-position="bottom"><img src="https://stagedog.github.io/_images/%E6%8F%90%E7%A4%BA%E8%AF%8D%E6%9F%A5%E7%9C%8B%E5%99%A8.png" width="500"></a>
</p><p></p>
</div>
</div>
</div>
<p>이것이 처음 프롬프트와 실제 전송 내용이 다른 경우가 아닙니다. 캐릭터 카드를 열어서 오프닝 메시지를 보면: 분명 오프닝 메시지에는 <code>&lt;user&gt;</code>라고 적혀 있지만, 실제로 표시되거나 AI에게 전송될 때는 구체적인 이름으로 바뀝니다.</p>
<p align="center">
  <a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="https://stagedog.github.io/_images/user%E5%AE%8F.png" data-desc-position="bottom"><img src="https://stagedog.github.io/_images/user%E5%AE%8F.png" width="500"></a>
</p>

<p>즉, <code>{{format_message_variable::stat_data}}</code>나 <code>&lt;user&gt;</code> 같은 텍스트는 <strong>플레이스홀더(자리 표시자)</strong>일 뿐이며, 실제로 표시되거나 전송될 때는 구체적인 내용으로 대체됩니다.</p>
<ul>
<li><strong>이러한 플레이스홀더 텍스트를 "매크로(Macro)"라고 합니다.</strong><ul>
<li><code>&lt;user&gt;</code> 또는 <code>{{user}}</code>는 SillyTavern 매크로입니다. SillyTavern 입력창에 <code>/help macros</code>를 입력하고 엔터를 치면 어떤 매크로가 제공되는지 알 수 있습니다.</li>
<li>반면 <code>{{format_message_variable::변수}}</code>는 TavernHelper(酒馆助手)가 새로 등록한 매크로입니다.</li>
</ul>
</li>
</ul>
<h3 id="tavernhelper-format_message_variable">TavernHelper 매크로 <code>{{format_message_variable::변수}}</code><a class="headerlink" href="#tavernhelper-format_message_variable" title="Permanent link">¶</a></h3>
<p>TavernHelper는 SillyTavern의 기능을 확장하고 변수를 더 잘 지원하기 위해 <a href="https://n0vi028.github.io/JS-Slash-Runner-Doc/guide/%E5%8A%9F%E8%83%BD%E8%AF%A6%E6%83%85/%E9%85%92%E9%A6%86%E5%8A%A9%E6%89%8B%E5%AE%8F.html">TavernHelper 매크로 등록</a>을 허용하며, <code>{{format_message_variable::변수}}</code> 매크로를 미리 제공합니다. 이 매크로의 역할은 <strong>최신 메시지 층의 변수를 표시</strong>하는 것입니다.</p>
<p>여기서 <code>변수</code>는 표시할 변수의 경로입니다. 즉, <code>{{format_message_variable::stat_data}}</code>는 <code>stat_data</code> 경로 아래의 변수 내용을 표시합니다... 헷갈리시나요? 괜찮습니다. <strong>SillyTavern 입력창 왼쪽의 마법봉  변수 관리자  메시지 층</strong>을 열어 확인해 봅시다:</p>
<p align="center">
  <a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/83bbaf6d-6b47-4654-821f-dcd0d716cc1b.png" data-desc-position="bottom"><img src="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/83bbaf6d-6b47-4654-821f-dcd0d716cc1b.png" width="500"></a>
</p>

<p><code>stat_data</code> 변수 아래에 우리가 설정한 모든 변수가 있습니다! 따라서 <code>{{format_message_variable::stat_data}}</code>는 우리가 설정한 모든 변수를 형식에 맞게 표시합니다! 변수 목록은 바로 이 점을 활용한 것입니다.</p>
<p><code>{{format_message_variable::변수}}</code>는 다른 경로도 사용할 수 있습니다. 변수 관리자에서 경로를 복사해 봅시다: "현재시간"을 클릭한 다음, 변수 관리자 상단의 네비게이션 바를 편집하여 경로를 복사합니다.</p>
<p align="center">
  <a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="https://stagedog.github.io/_images/%E5%A4%8D%E5%88%B6%E5%8F%98%E9%87%8F%E8%B7%AF%E5%BE%84.png" data-desc-position="bottom"><img src="https://stagedog.github.io/_images/%E5%A4%8D%E5%88%B6%E5%8F%98%E9%87%8F%E8%B7%AF%E5%BE%84.png" width="500"></a>
</p>

<p>우리가 얻은 경로는 <code>stat_data.세계.현재시간</code>이므로, SillyTavern 입력창에 <code>{{format_message_variable::stat_data.세계.현재시간}}</code>을 입력하고 전송해 봅시다:</p>
<p align="center">
  <a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="https://stagedog.github.io/_images/%E5%8F%91%E9%80%81%E9%85%92%E9%A6%86%E5%8A%A9%E6%89%8B%E5%AE%8F.png" data-desc-position="bottom"><img src="https://stagedog.github.io/_images/%E5%8F%91%E9%80%81%E9%85%92%E9%A6%86%E5%8A%A9%E6%89%8B%E5%AE%8F.png" width="500"></a>
</p>

<p>예상대로 AI 응답에 <code>2024-04-08 10:45</code>라는 시간이 나타났습니다!</p>
<div class="admonition tip">
<p class="admonition-title">팁</p>
<p>더 많은 TavernHelper 매크로 사용법은 <a href="https://n0vi028.github.io/JS-Slash-Runner-Doc/guide/%E5%8A%9F%E8%83%BD%E8%AF%A6%E6%83%85/%E9%85%92%E9%A6%86%E5%8A%A9%E6%89%8B%E5%AE%8F.html">TavernHelper 매크로</a> 문서를 참고하세요.</p>
</div>
<h3 id="ai_1">AI가 변수 목록의 값이 '최신'임을 알게 하기<a class="headerlink" href="#ai_1" title="Permanent link">¶</a></h3>
<p>변수 목록은 변수의 현재 값을 나열하지만, AI는 여전히 변수 목록의 값이 최신 스토리가 아니라 이전 스토리에 해당한다고 생각할 수 있습니다. 이것은 월드인포 항목의 삽입 위치 때문입니다.</p>
<p>일반적으로 프롬프트는 다음 순서로 프롬프트를 AI에게 전송합니다:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>캐릭터 정의 이전
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>캐릭터 정의 이후
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>0번째 메시지
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>1번째 메시지
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>...
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>끝에서 3번째 메시지
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>D2
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>끝에서 2번째 층 (마지막 AI 응답)
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>D1
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>끝에서 1번째 층 (마지막 사용자 입력)
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>D0
</code></pre></div>
<p>AI가 변수 목록이 <strong>최신 스토리(즉, 최신 AI 응답)</strong>에 해당한다는 것을 직접 이해하게 하려면, 변수 목록을 반드시 <strong>D1</strong> 또는 <strong>D0</strong> 위치에 설정해야 합니다.</p>
<div class="admonition tip">
<p class="admonition-title">해설: Depth(깊이)와 위치 선정</p>
<p>SillyTavern에서 <strong>Depth(깊이)</strong>는 채팅 로그의 끝(최신)에서부터 몇 번째 위에 있는지를 나타냅니다.</p>
<ul>
<li><strong>D0:</strong> 가장 최신 메시지 (보통 방금 내가 보낸 입력)</li>
<li><strong>D1:</strong> 바로 직전 메시지 (보통 직전 AI의 응답)</li>
</ul>
<p>변수 목록을 <strong>D1</strong>이나 <strong>D0</strong> 같은 최하단에 배치하는 이유는, LLM이 텍스트를 위에서 아래로 읽을 때 <strong>가장 마지막에 읽은 정보를 가장 중요하게 인식하는 경향</strong>이 있기 때문입니다.</p>
</div>
<p>AI가 변수 목록이 최신 스토리, 즉 최신 AI 응답에 해당한다는 것을 직접 이해하게 하려면, 변수 목록을 <strong>D1</strong> 또는 <strong>D0</strong> 위치에 설정해야 합니다.</p>
<h3 id="_2">변수 의미 구체적으로 설명하기<a class="headerlink" href="#_2" title="Permanent link">¶</a></h3>
<p>변수 목록은 AI에게 변수의 현재 값뿐만 아니라, <strong>변수가 어떤 의미인지</strong>도 알려주는 역할을 합니다.</p>
<p>일부 변수의 의미는 이름에서 알 수 있습니다. 예를 들어 <code>세계.현재시간</code>, <code>세계.현재장소</code>, <code>주인공.아이템란</code> 등이 있습니다. 하지만 일부 변수는 특별한 의미가 있어서 추가 설명이 필요합니다.</p>
<p>예를 들어 <code>하쿠아.의존도</code>의 경우, AI는 이름에서 하쿠아가 주인공에게 갖는 의존 정도라는 것을 알 수 있지만, 구체적인 수치(예: 23)에서 하쿠아가 어떤 심리 상태여야 하는지, 어떤 행동을 취하는 경향이 있는지는 추가 설명이 필요합니다.</p>
<p>이것이 바로 많은 카드에서 말하는 <strong>"단계별 호감도"</strong> 메커니즘입니다: 서로 다른 의존도에 따라 하쿠아는 다른 행동과 심리 상태를 보여야 합니다.</p>
<p>현재로서는 새로운 <code>캐릭터 단계</code> 항목을 만들어 각 의존도 단계에서 하쿠아의 행동을 간단히 나열할 수 있습니다:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nt">하쿠아 현재 행동</span><span class="p">:</span><span class="w"> </span><span class="c1"># 하쿠아의 현재 의존도는 {{format_message_variable::stat_data.하쿠아.의존도}}이므로, 아래 예시와 유사한 행동을 취하는 경향이 있음</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span><span class="c1"># 0~19일 때</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span><span class="nt">소극적 자해</span><span class="p">:</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">  </span><span class="c1"># 20~39일 때</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">  </span><span class="nt">시선 갈구</span><span class="p">:</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">  </span><span class="c1"># 40~59일 때</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">  </span><span class="nt">몰래 접근</span><span class="p">:</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">  </span><span class="c1"># 60~79일 때</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">  </span><span class="nt">불안한 의지</span><span class="p">:</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">  </span><span class="c1"># 80~100일 때</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="w">  </span><span class="nt">부드러운 의존</span><span class="p">:</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>하지만 이 방식에는 분명한 문제가 있습니다. 현재 하쿠아의 의존도가 <strong>23</strong>임에도 불구하고, 우리는 여전히 <strong>0~19, 40~59 등 해당하지 않는 단계의 프롬프트까지 모두 전송</strong>하고 있다는 점입니다.</p>
<p>이는 입력 토큰을 낭비할 뿐만 아니라, AI의 주의력(Attention)을 분산시켜 AI가 하쿠아에게 어떤 단계의 행동을 취하게 해야 할지 혼란을 줄 수 있습니다.</p>
<p>다음 장에서는 <strong>프롬프트 템플릿</strong>을 사용하여 이 문제를 해결하는 방법을 알려드리겠습니다. 지금은 3대 변수 프롬프트 중 두 번째인 <strong>변수 업데이트 규칙</strong>을 배워봅시다.</p>
<hr>
<h2 id="_3">변수 업데이트 규칙<a class="headerlink" href="#_3" title="Permanent link">¶</a></h2>
<p>변수 업데이트 규칙은 AI에게 <strong>변수가 어떤 상황에서 업데이트되어야 하며, 어떤 값으로 변해야 하는지</strong> 알려줍니다.</p>
<p>문지기(Gatekeeper) 카드 작성 도우미의 변수 업데이트 규칙 작성법은 변수 구조, 변수 초기값, 변수 목록과 유사합니다.</p>
<details class="note">
<summary>생성된 변수 업데이트 규칙 (클릭하여 펼치기)</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nt">변수 업데이트 규칙</span><span class="p">:</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">  </span><span class="nt">세계</span><span class="p">:</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="nt">현재 시간</span><span class="p">:</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">YYYY년 MM월 DD일 요일X HH:MM</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span><span class="nt">최근 사건</span><span class="p">:</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">        </span><span class="no">{</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">          </span><span class="no">[사건명: string]: string; // 사건 설명</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">        </span><span class="no">}</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">      </span><span class="nt">check</span><span class="p">:</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">완료해야 할 임무, 약속, 중요 사건 등을 기록</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">완료 후 목록에서 제거, 새로운 사건 발생 시 즉시 추가</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">활성 사건은 최대 5~8개로 유지하여 과도한 복잡성 방지</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">  </span><span class="nt">하쿠아</span><span class="p">:</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">    </span><span class="nt">의존도</span><span class="p">:</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">number</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">      </span><span class="nt">range</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0~100</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">      </span><span class="nt">check</span><span class="p">:</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;user&gt;의 행동에 대한 하쿠아의 인지와 반응에 따라 ±(3~6) 조정</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">하쿠아가 현재 &lt;user&gt;의 행동을 알아챘을 때만 업데이트</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">복장.${상의|하의|속옷|양말|신발|장식}</span><span class="p p-Indicator">:</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="w">      </span><span class="nt">check</span><span class="p">:</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">환복, 의복 손상, 특수 상황 시 업데이트</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">설명에는 색상, 재질, 스타일 등의 세부 정보 포함</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">하쿠아의 심리 상태와 &lt;user&gt;에 대한 관심도 반영</span>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a><span class="w">    </span><span class="nt">칭호</span><span class="p">:</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="w">        </span><span class="no">{</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="w">          </span><span class="no">[칭호명: string]: {</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a><span class="w">            </span><span class="no">효과: string;</span>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a><span class="w">            </span><span class="no">자가 평가?: string;  // 기본값은 '평가 대기'</span>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a><span class="w">          </span><span class="no">}</span>
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a><span class="w">        </span><span class="no">}</span>
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a><span class="w">      </span><span class="nt">check</span><span class="p">:</span>
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">하쿠아의 중요한 행동, 심리 변화 또는 &lt;user&gt;와의 상호작용을 기반으로 획득</span>
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">자가 평가가 '평가 대기'라면 즉시 자가 평가 업데이트</span>
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">칭호는 하쿠아의 현재 의존 상태와 심리적 발전을 반영해야 함</span>
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">최대 Math.ceil(의존도/10)개의 칭호 유지, 초과 시 가장 오래된 것 제거</span>
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a><span class="w">  </span><span class="nt">주인공</span><span class="p">:</span>
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a><span class="w">    </span><span class="nt">아이템란</span><span class="p">:</span>
<a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a><span class="w">        </span><span class="no">{</span>
<a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a><span class="w">          </span><span class="no">[아이템명: string]: {</span>
<a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a><span class="w">            </span><span class="no">설명: string;</span>
<a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a><span class="w">            </span><span class="no">수량?: number;  // 기본값은 1</span>
<a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a><span class="w">          </span><span class="no">}</span>
<a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a><span class="w">        </span><span class="no">}</span>
<a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a><span class="w">      </span><span class="nt">check</span><span class="p">:</span>
<a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">아이템 획득, 소모, 폐기 시 수량 업데이트</span>
<a id="__codelineno-5-50" name="__codelineno-5-50" href="#__codelineno-5-50"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">수량이 0이 되면 해당 항목 표시 안 함</span>
</code></pre></div>
</details>
<p>예를 들어 <code>하쿠아.의존도</code>와 <code>하쿠아.칭호</code>는 다음과 같이 나열됩니다:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio"><input id="__tabbed_2_2" name="__tabbed_2" type="radio"><div class="tabbed-labels"><label for="__tabbed_2_1">변수 목록</label><label for="__tabbed_2_2">변수 업데이트 규칙</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nt">하쿠아</span><span class="p">:</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">  </span><span class="nt">의존도</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">  </span><span class="nt">칭호</span><span class="p">:</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="nt">전학생</span><span class="p">:</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">      </span><span class="nt">효과</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">막 도착해서 환경에 낯설고, 다른 사람의 주목을 받기 쉽지만 본인은 저자세를 유지하려 함</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">      </span><span class="nt">자기평가</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">또 다른 새로운 시작이지만, 난 분명 다시 망칠 거야</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nt">하쿠아</span><span class="p">:</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">  </span><span class="nt">의존도</span><span class="p">:</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">number</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="nt">range</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0~100</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span><span class="nt">check</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;user&gt;의 행동에 대한 하쿠아의 인식과 반응에 따라 조정, (3~6)</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">  </span><span class="nt">칭호</span><span class="p">:</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">${칭호명}</span><span class="p p-Indicator">:</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">칭호명은 칭호의 의미를 담은 간결한 단어여야 함</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">      </span><span class="nt">효과</span><span class="p">:</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">        </span><span class="nt">check</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">하쿠아의 중요한 행동, 심리 변화 또는 &lt;user&gt;와의 상호작용을 기반으로 획득</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">      </span><span class="nt">자기평가</span><span class="p">:</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">        </span><span class="nt">check</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">하쿠아의 자기 평가</span>
</code></pre></div>
</div>
</div>
</div>
<p>변수 업데이트 규칙에서 변수 구조를 사용하면 장점이 분명합니다: AI가 각 업데이트 규칙이 어떤 변수에 해당하는지 쉽게 알 수 있고, 동일한 구조가 AI의 변수 구조 이해를 더욱 강화합니다.</p>
<h3 id="_4">각 항목의 의미<a class="headerlink" href="#_4" title="Permanent link">¶</a></h3>
<p>문지기(Gatekeeper) 카드 작성 도우미의 변수 업데이트 규칙에서 AI가 사용할 수 있는 필드는 다음과 같습니다:</p>
<p><strong>(직접 문지기 카드 작성 도우미가 생성하게 하고, 불필요한 업데이트 규칙을 삭제한 후 <code>check</code> 부분만 약간 수정하는 것을 권장합니다.)</strong></p>
<ul>
<li>
<p><strong><code>type</code>: 변수가 지원하는 타입</strong>
    예를 들어 <code>하쿠아.의존도</code>는 숫자(<code>number</code>)이고, <code>임무진행도</code>는 <code>'미수령'|'진행중'|'완료'</code>일 수 있습니다. 우리가 생성한 변수 구조가 이미 변수가 지원하는 타입을 규정했지만 AI는 아직 모르므로, 여기서 알려줘서 항상 허용되는 값으로 업데이트하게 합니다.</p>
</li>
<li>
<p><strong><code>range</code>: 숫자 변수가 있어야 하는 범위</strong>
    예를 들어 <code>하쿠아.의존도</code>는 반드시 0~100 사이여야 합니다. 이것도 변수 구조에서 규정했지만, AI에게 알려주면 더 좋습니다:AI가 의존도를 <code>128</code>로 업데이트했다가 강제로 <code>100</code>으로 수정되는 것보다는, AI가 처음부터 <code>0~100</code> 사이여야 함을 알고 적절한 값으로 계산하는 것이 더 바람직하기 때문입니다.</p>
</li>
<li>
<p><strong><code>format</code>: 변수가 만족해야 하는 특정 형식</strong>
    예를 들어 <code>세계.현재시간</code>은 반드시 <code>YYYY년MM월DD일 요일 HH:MM</code> 형식이어야 합니다.
    변수 구조에서 강제할 수도 있지만, 예시 카드에서는 그렇게 하지 않고 변수 업데이트 규칙에 <code>format</code> 한 줄을 적어 AI에게 알리기만 했습니다. </p>
<ul>
<li>왜냐하면 <code>월드.현재 시간</code>은 AI가 현재 시간을 인지하기 위한 용도이므로 형식이 완벽하지 않아도(예: <code>HH:MM YYYY/MM/DD</code>) 기능을 수행하는 데 문제가 없기 때문입니다.</li>
</ul>
</li>
<li>
<p><strong><code>check</code>: AI가 변수를 업데이트할 때 고려해야 하는 논리적 요소</strong>
    예를 들어 <code>하쿠아.의존도</code>는 <code>하쿠아가 &lt;user&gt; 행동에 대한 인식과 반응에 따라 조정</code>해야 하고, <code>(3~6)</code>이며, <code>하쿠아.칭호</code>는 <code>하쿠아의 중요한 행동, 심리 변화 또는 &lt;user&gt;와의 상호작용을 기반으로 획득</code>해야 합니다. 사실상 이 부분이 핵심입니다. 변수가 <strong>어떤 상황에서 업데이트되어야 하는지</strong>, <strong>어떤 값으로 변해야 하는지</strong>를 자연어로 상세히 서술하면 됩니다.</p>
</li>
</ul>
<h3 id="_5">변수 업데이트 규칙 중복 작성 피하기<a class="headerlink" href="#_5" title="Permanent link">¶</a></h3>
<p>물론 변수 목록에 따라 각 변수의 업데이트 규칙을 일일이 나열할 수 있지만, 이는 많은 중복 작업과 어려움을 초래합니다:</p>
<ul>
<li><code>세계.현재장소</code> 같은 변수는 이름 자체가 AI에게 어떻게 업데이트해야 하는지 알려주므로, 따로 업데이트 규칙을 작성할 필요가 없습니다.</li>
<li><code>하쿠아.복장.상의</code>, <code>하쿠아.복장.하의</code> 같은 변수는 업데이트 규칙이 거의 동일하므로, 중복 작성할 필요가 없습니다.</li>
<li><code>칭호</code> 같은 변수는 내부에 어떤 항목이 있는지 알 수 없으므로, 업데이트 규칙에서 일일이 나열할 수 없습니다.</li>
</ul>
<p>예시 카드의 변수 업데이트 규칙을 보면, 문지기 카드 작성 도우미가 이미 위 문제를 고려했음을 알 수 있습니다:</p>
<ul>
<li>이름 자체가 업데이트 방법을 알려주는 <code>세계.현재장소</code> 같은 변수는 생략을 시도합니다  직접 작성할 때도 이렇게 해야 합니다.</li>
<li><code>하쿠아.복장.상의</code>, <code>하쿠아.복장.하의</code> 같은 변수는 병합을 시도하여, <code>하쿠아.복장.${상의|하의|속옷|양말|신발|장신구}</code>에 대한 업데이트 규칙을 직접 작성합니다  직접 작성할 때도 이렇게 해야 합니다.</li>
<li><code>칭호</code> 아래의 <code>칭호명</code>이 임의적이라는 것을 이해하고, <code>칭호명</code>을 <code>type</code> 부분에 넣어 설명합니다. </li>
</ul>
<h3 id="_6">변수 구조를 변수 업데이트 규칙으로 직접 사용하기<a class="headerlink" href="#_6" title="Permanent link">¶</a></h3>
<p>문지기 카드 작성 도우미가 변수 업데이트 규칙을 작성하게 하는 것 외에, 또 다른 편법은 생성된 변수 구조를 직접 변수 업데이트 규칙으로 사용하는 것입니다.</p>
<p>앞서 변수 업데이트 규칙의 필드를 설명할 때 알 수 있듯이: <code>type</code>, <code>range</code>, <code>format</code> 필드는 모두 변수 구조에서 규정한 내용이고, 우리가 유일하게 작성해야 하는 것은 <code>check</code> 부분입니다.</p>
<p>예를 들어, 변수 업데이트 규칙을 다음과 같이 직접 입력할 수 있습니다:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio"><input id="__tabbed_3_2" name="__tabbed_3" type="radio"><input id="__tabbed_3_3" name="__tabbed_3" type="radio"><div class="tabbed-labels"><label for="__tabbed_3_1">변수 구조</label><label for="__tabbed_3_2">변수 구조를 type에 사용</label><label for="__tabbed_3_3">전체 변수 구조를 직접 복사</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">registerMvuSchema</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/util/mvu_zod.js'</span><span class="p">;</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">  </span><span class="nx">하쿠아</span><span class="o">:</span><span class="w"> </span><span class="nx">z</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">    </span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="hll"><span class="w">      </span><span class="nx">의존도</span><span class="o">:</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">coerce</span><span class="p">.</span><span class="nx">number</span><span class="p">().</span><span class="nx">transform</span><span class="p">(</span><span class="nx">v</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">_</span><span class="p">.</span><span class="nx">clamp</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">)),</span>
</span><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="p">});</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="nx">$</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="w">  </span><span class="nx">registerMvuSchema</span><span class="p">(</span><span class="nx">Schema</span><span class="p">);</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="p">});</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nn">---</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="nt">변수 업데이트 규칙</span><span class="p">:</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">  </span><span class="nt">하쿠아</span><span class="p">:</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">    </span><span class="nt">의존도</span><span class="p">:</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="hll"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">z.coerce.number().transform(v =&gt; _.clamp(v, 0, 100))</span>
</span><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">      </span><span class="nt">check</span><span class="p">:</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">하쿠아가 &lt;user&gt; 행동에 대한 인식과 반응에 따라 조정 ±(3~6)</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">하쿠아가 현재 &lt;user&gt;의 행동을 인지했을 때만 업데이트</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nn">---</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="nt">변수 업데이트 규칙</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">  </span><span class="no">z.object({</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="no">하쿠아: z</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">      </span><span class="no">.object({</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="hll"><span class="w">        </span><span class="no">/**</span>
</span><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="hll"><span class="w">         </span><span class="no">* check:</span>
</span><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="hll"><span class="w">         </span><span class="no">*   - 하쿠아가 &lt;user&gt; 행동에 대한 인식과 반응에 따라 조정 ±(3~6)</span>
</span><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="hll"><span class="w">         </span><span class="no">*   - 하쿠아가 현재 &lt;user&gt;의 행동을 인지했을 때만 업데이트</span>
</span><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="hll"><span class="w">         </span><span class="no">*/</span>
</span><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">        </span><span class="no">의존도: z.coerce.number().transform(v =&gt; _.clamp(v, 0, 100)),</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">      </span><span class="no">})</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">  </span><span class="no">});</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="_7">변수 업데이트 규칙의 삽입 위치<a class="headerlink" href="#_7" title="Permanent link">¶</a></h3>
<p>변수 목록이 최신 스토리와 연결되어야 하는 것과 달리, 변수 업데이트 규칙은 보통 스토리 전개와 무관하므로 D1이나 D0 위치에 삽입할 필요가 없습니다.</p>
<p>변수 업데이트 규칙을 스토리 전개와 무관한 위치에 삽입할 수 있습니다. 예: 캐릭터 정의 이후, 캐릭터 정의 이전 등. Claude의 경우 D3, D4 등의 위치에 삽입할 수도 있습니다. 이러한 위치는 AI의 주의력을 덜 차지하여, AI가 다른 프롬프트에 더 집중할 수 있게 합니다. 물론 편의상 D0에 넣어도 됩니다.</p>
<p>하지만 AI가 변수 업데이트 규칙에 덜 주의하면, 변수 업데이트 시 실수가 더 늘어나지 않을까요? 그렇습니다. 하지만 변수 출력 형식의 <strong>사고 체인(Chain of Thought, CoT)</strong>이 이를 보완해 줍니다.</p>
<hr>
<h2 id="_8">변수 출력 형식<a class="headerlink" href="#_8" title="Permanent link">¶</a></h2>
<p>변수 출력 형식은 AI에게 <strong>변수를 업데이트하기 위해 무엇을 출력해야 하는지</strong> 알려줍니다.</p>
<p>문지기 카드 작성 도우미의 변수 출력 형식은 청공리(Aozora Rii)의 <a href="https://stagedog.github.io/%E9%9D%92%E7%A9%BA%E8%8E%89/%E5%B7%A5%E5%85%B7%E7%BB%8F%E9%AA%8C/%E6%8F%90%E7%A4%BA%E8%AF%8D%E4%B8%AA%E4%BA%BA%E5%86%99%E6%B3%95/%E9%A2%9D%E5%A4%96%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F/">추가 출력 형식</a> 작성법을 채택했습니다. <code>rule</code>은 출력 규칙이고, <code>format</code> 부분은 출력 형식입니다.</p>
<p>AI는 응답 중에 [변수 출력 형식]에서 지정한 형식으로 변수를 업데이트합니다:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:3"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio"><input id="__tabbed_4_2" name="__tabbed_4" type="radio"><input id="__tabbed_4_3" name="__tabbed_4" type="radio"><div class="tabbed-labels"><label for="__tabbed_4_1">영문 프롬프트</label><label for="__tabbed_4_2">한글 프롬프트 (번역)</label><label for="__tabbed_4_3">AI 출력 결과 예시</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># 원문 유지를 위해 영문 그대로 제공됩니다.</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="nt">variable_output_format</span><span class="p">:</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">  </span><span class="nt">rule</span><span class="p">:</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">you must output the update analysis and the actual update commands at once in the end of the next reply</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">the update commands works like the **JSON Patch (RFC 6902)** standard, must be a valid JSON array containing operation objects, but supports the following operations instead</span><span class="p p-Indicator">:</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">replace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">replace the value of existing paths</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">delta</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">update the value of existing number paths by a delta value</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">insert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">insert new items into an object or array (using `-` as array index intends appending to the end)</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">remove</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">don't update field names starts with `_` as they are readonly, such as `_variable`</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">  </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">    </span><span class="no">&lt;UpdateVariable&gt;</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">    </span><span class="no">&lt;Analysis&gt;$(IN ENGLISH, no more than 80 words)</span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">    </span><span class="no">- ${calculate time passed: ...}</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="w">    </span><span class="no">- ${decide whether dramatic updates are allowed as it's in a special case or the time passed is more than usual: yes/no}</span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="w">    </span><span class="no">- ${analyze every variable based on its corresponding `check`, according only to current reply instead of previous plots: ...}</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="w">    </span><span class="no">&lt;/Analysis&gt;</span>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">    </span><span class="no">&lt;JSONPatch&gt;</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="w">    </span><span class="no">[</span>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="w">      </span><span class="no">{ "op": "replace", "path": "${/path/to/variable}", "value": "${new_value}" },</span>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">      </span><span class="no">{ "op": "delta", "path": "${/path/to/number/variable}", "value": "${positve_or_negative_delta}" },</span>
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">      </span><span class="no">{ "op": "insert", "path": "${/path/to/object/new_key}", "value": "${new_value}" },</span>
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="w">      </span><span class="no">{ "op": "insert", "path": "${/path/to/array/-}", "value": "${new_value}" },</span>
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="w">      </span><span class="no">{ "op": "remove", "path": "${/path/to/object/key}" },</span>
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a><span class="w">      </span><span class="no">{ "op": "remove", "path": "${/path/to/array/0}" },</span>
<a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a><span class="w">      </span><span class="no">...</span>
<a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a><span class="w">    </span><span class="no">]</span>
<a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a><span class="w">    </span><span class="no">&lt;/JSONPatch&gt;</span>
<a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a><span class="w">    </span><span class="no">&lt;/UpdateVariable&gt;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># 이해를 돕기 위해 주석 및 플레이스홀더를 한국어로 번역한 버전입니다.</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="nt">변수_출력_형식</span><span class="p">:</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">  </span><span class="nt">rule</span><span class="p">:</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">반드시 답변 마지막에 업데이트 분석과 실제 업데이트 명령을 한 번에 출력해야 함</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">업데이트 명령 효과는 **JSON Patch (RFC 6902)** 표준과 유사함. 유효한 JSON 배열이어야 하며 표준 대신 다음 작업을 지원함</span><span class="p">:</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">replace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">기존 변수 경로의 값을 교체</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">delta</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">변동값을 사용하여 기존 수치 변수를 업데이트</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">insert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">객체나 배열에 새 항목 삽입 (`-`를 배열 인덱스로 사용하면 끝에 추가됨을 의미)</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">remove</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">제거</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">`_`로 시작하는 필드명은 읽기 전용이므로 업데이트하지 말 것 (예</span><span class="p">:</span><span class="w"> </span><span class="err">`</span><span class="l l-Scalar l-Scalar-Plain">_변수`)</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="w">  </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="w">    </span><span class="no">&lt;UpdateVariable&gt;</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="w">    </span><span class="no">&lt;Analysis&gt;$(영어로 출력, 80단어 이하)</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="w">    </span><span class="no">- ${경과한 시간 계산: ...}</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="w">    </span><span class="no">- ${현재 전개가 충분히 특수한지, 시간 경과가 정상 범위를 훨씬 초과했는지에 따라 변수값의 극적인 변화 허용 여부 판단: 예/아니오}</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="w">    </span><span class="no">- ${변수에 대응하는 `check`를 기반으로, 이전 줄거리가 아닌 현재 답변에만 근거하여 각 변수의 업데이트 필요성 분석: ...}</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="w">    </span><span class="no">&lt;/Analysis&gt;</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="w">    </span><span class="no">&lt;JSONPatch&gt;</span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="w">    </span><span class="no">[</span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="w">      </span><span class="no">{ "op": "replace", "path": "${/변수/경로}", "value": "${새_값}" },</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="w">      </span><span class="no">{ "op": "delta", "path": "${/수치/변수/경로}", "value": "${양수_또는_음수의_변동값}" },</span>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="w">      </span><span class="no">{ "op": "insert", "path": "${/객체/새_키/경로}", "value": "${새_값}" },</span>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="w">      </span><span class="no">{ "op": "insert", "path": "${/배열/-}", "value": "${새_값}" },</span>
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="w">      </span><span class="no">{ "op": "remove", "path": "${/객체/키/경로}" },</span>
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="w">      </span><span class="no">{ "op": "remove", "path": "${/배열/경로/0}" },</span>
<a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a><span class="w">      </span><span class="no">...</span>
<a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a><span class="w">    </span><span class="no">]</span>
<a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a><span class="w">    </span><span class="no">&lt;/JSONPatch&gt;</span>
<a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a><span class="w">    </span><span class="no">&lt;/UpdateVariable&gt;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>(앞부분 줄거리 생략...)
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>&lt;UpdateVariable&gt;
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>&lt;Analysis&gt;
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="k">-</span><span class="w"> </span>Time advanced by 10 minutes (from 10:47 to 10:57) for the class break and the subsequent interaction.
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="k">-</span><span class="w"> </span>Special Case? No, routine plot progression, no dramatic time skips.
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="k">-</span><span class="w"> </span>하쿠아.의존도: Baiya showed a strong reaction to Qingkong Li (trembling, calling him "brother", self-denial but accepting the candy secretly). She definitely noticed his attention and action. This indicates a significant emotional impact, warranting an increase.
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="k">-</span><span class="w"> </span>하쿠아.칭호: The "哥哥" slip-up and the immediate self-punishment reinforce her internal conflict, but doesn't necessarily grant a new title yet. Her current titles are still very relevant.
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="k">-</span><span class="w"> </span>주인공.아이템란: The mints were placed on Baiya's desk. The item should be removed from inventory.
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="k">-</span><span class="w"> </span>월드 인포.최근 사건: "转学生安置" (전학생 적응) is ongoing but the specific interaction happened. "午休临近" (점심시간 임박) is becoming more relevant as break continues.
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>&lt;/Analysis&gt;
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>&lt;JSONPatch&gt;
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>[
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>  { "op": "replace", "path": "/월드 인포/현재 시간", "value": "2024-04-08 10:57" },
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>  { "op": "replace", "path": "/하쿠아/의존도", "value": 40 },
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>  { "op": "remove", "path": "/주인공/아이템란/박하사탕" }
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>]
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>&lt;/JSONPatch&gt;
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>&lt;/UpdateVariable&gt;
</code></pre></div>
</div>
</div>
</div>
<h2 id="_9">변수 출력 형식<a class="headerlink" href="#_9" title="Permanent link">¶</a></h2>
<p>변수 출력 형식은 AI에게 변수를 업데이트하기 위해 무엇을 출력해야 하는지 알려줍니다.</p>
<p>문지기(Gatekeeper) 캐릭터 작성 도우미의 변수 출력 형식은 Aozora Rii(青空莉)의 [추가 출력 형식] 작성법을 채택했으며, <code>rule</code> 부분은 출력 규칙이고, <code>format</code> 부분은 출력 형식입니다.</p>
<p>따라서 AI는 답변 중에서 <code>변수 출력 형식</code>이 지정한 형식에 따라 변수를 업데이트합니다.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio"><input id="__tabbed_5_2" name="__tabbed_5" type="radio"><input id="__tabbed_5_3" name="__tabbed_5" type="radio"><div class="tabbed-labels"><label for="__tabbed_5_1">영문 프롬프트</label><label for="__tabbed_5_2">한글 프롬프트</label><label for="__tabbed_5_3">AI 출력 결과 예시</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nt">variable_output_format</span><span class="p">:</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">  </span><span class="nt">rule</span><span class="p">:</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">you must output the update analysis and the actual update commands at once in the end of the next reply</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">the update commands works like the **JSON Patch (RFC 6902)** standard, must be a valid JSON array containing operation objects, but supports the following operations instead</span><span class="p p-Indicator">:</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">replace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">replace the value of existing paths</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">delta</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">update the value of existing number paths by a delta value</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">insert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">insert new items into an object or array (using `-` as array index intends appending to the end)</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">remove</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">don't update field names starts with `_` as they are readonly, such as `_variable`</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">  </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w">    </span><span class="no">&lt;UpdateVariable&gt;</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="w">    </span><span class="no">&lt;Analysis&gt;$(IN ENGLISH, no more than 80 words)</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="w">    </span><span class="no">- ${calculate time passed: ...}</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="w">    </span><span class="no">- ${decide whether dramatic updates are allowed as it's in a special case or the time passed is more than usual: yes/no}</span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="w">    </span><span class="no">- ${analyze every variable based on its corresponding `check`, according only to current reply instead of previous plots: ...}</span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="w">    </span><span class="no">&lt;/Analysis&gt;</span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="w">    </span><span class="no">&lt;JSONPatch&gt;</span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="w">    </span><span class="no">[</span>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="w">      </span><span class="no">{ "op": "replace", "path": "${/path/to/variable}", "value": "${new_value}" },</span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="w">      </span><span class="no">{ "op": "delta", "path": "${/path/to/number/variable}", "value": "${positve_or_negative_delta}" },</span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="w">      </span><span class="no">{ "op": "insert", "path": "${/path/to/object/new_key}", "value": "${new_value}" },</span>
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="w">      </span><span class="no">{ "op": "insert", "path": "${/path/to/array/-}", "value": "${new_value}" },</span>
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="w">      </span><span class="no">{ "op": "remove", "path": "${/path/to/object/key}" },</span>
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="w">      </span><span class="no">{ "op": "remove", "path": "${/path/to/array/0}" },</span>
<a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="w">      </span><span class="no">...</span>
<a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="w">    </span><span class="no">]</span>
<a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a><span class="w">    </span><span class="no">&lt;/JSONPatch&gt;</span>
<a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a><span class="w">    </span><span class="no">&lt;/UpdateVariable&gt;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nt">변수_출력_형식</span><span class="p">:</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">  </span><span class="nt">rule</span><span class="p">:</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">반드시 답변 마지막에 업데이트 분석과 실제 업데이트 명령을 한 번에 출력해야 함</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">업데이트 명령 효과는 **JSON Patch (RFC 6902)** 표준과 유사함. 유효한 JSON 배열이어야 하며 다음 작업을 지원함</span><span class="p">:</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">replace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">기존 변수 경로의 값을 교체</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">delta</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">변동값을 사용하여 기존 수치 변수를 업데이트</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">insert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">객체나 배열에 새 항목 삽입 (`-`를 배열 인덱스로 사용하면 끝에 추가됨을 의미)</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">remove</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">제거</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">`_`로 시작하는 필드명은 읽기 전용이므로 업데이트하지 말 것 (예</span><span class="p">:</span><span class="w"> </span><span class="err">`</span><span class="l l-Scalar l-Scalar-Plain">_변수`)</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">  </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w">    </span><span class="no">&lt;UpdateVariable&gt;</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">    </span><span class="no">&lt;Analysis&gt;$(영어로 출력, 80단어 이하)</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w">    </span><span class="no">- ${경과한 시간 계산: ...}</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">    </span><span class="no">- ${현재 전개가 충분히 특수한지, 시간 경과가 정상 범위를 훨씬 초과했는지에 따라 변수값의 극적인 변화 허용 여부 판단: 예/아니오}</span>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="w">    </span><span class="no">- ${변수에 대응하는 `check`를 기반으로, 이전 줄거리가 아닌 현재 답변에만 근거하여 각 변수의 업데이트 필요성 분석: ...}</span>
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="w">    </span><span class="no">&lt;/Analysis&gt;</span>
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="w">    </span><span class="no">&lt;JSONPatch&gt;</span>
<a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="w">    </span><span class="no">[</span>
<a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a><span class="w">      </span><span class="no">{ "op": "replace", "path": "${/변수/경로}", "value": "${새_값}" },</span>
<a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="w">      </span><span class="no">{ "op": "delta", "path": "${/수치/변수/경로}", "value": "${양수_또는_음수의_변동값}" },</span>
<a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="w">      </span><span class="no">{ "op": "insert", "path": "${/객체/새_키/경로}", "value": "${새_값}" },</span>
<a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="w">      </span><span class="no">{ "op": "insert", "path": "${/배열/-}", "value": "${새_값}" },</span>
<a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a><span class="w">      </span><span class="no">{ "op": "remove", "path": "${/객체/키/경로}" },</span>
<a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="w">      </span><span class="no">{ "op": "remove", "path": "${/배열/경로/0}" },</span>
<a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="w">      </span><span class="no">...</span>
<a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a><span class="w">    </span><span class="no">]</span>
<a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a><span class="w">    </span><span class="no">&lt;/JSONPatch&gt;</span>
<a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a><span class="w">    </span><span class="no">&lt;/UpdateVariable&gt;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>&lt;UpdateVariable&gt;
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>&lt;Analysis&gt;
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>- Time advanced by 10 minutes (from 10:47 to 10:57) for the class break and the subsequent interaction.
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>- Special Case? No, routine plot progression, no dramatic time skips.
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>- 하쿠아.의존도: Baiya showed a strong reaction to Qingkong Li (trembling, calling him "brother", self-denial but accepting the candy secretly). She definitely noticed his attention and action. This indicates a significant emotional impact, warranting an increase.
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>- 하쿠아.칭호: The "哥哥" slip-up and the immediate self-punishment reinforce her internal conflict, but doesn't necessarily grant a new title yet. Her current titles are still very relevant.
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>- 주인공.아이템란: The mints were placed on Baiya's desk. The item should be removed from inventory.
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>- 월드 인포.최근 사건: "전학생 적응" (전학생 적응) is ongoing but the specific interaction happened. "午休临近" (점심시간 임박) is becoming more relevant as break continues.
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>&lt;/Analysis&gt;
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>&lt;JSONPatch&gt;
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>[
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>  { "op": "replace", "path": "/월드 인포/현재 시간", "value": "2024-04-08 10:57" },
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>  { "op": "replace", "path": "/하쿠아/의존도", "value": 40 },
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>  { "op": "remove", "path": "/주인공/아이템란/박하사탕" }
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>]
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>&lt;/JSONPatch&gt;
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>&lt;/UpdateVariable&gt;
</code></pre></div>
</div>
</div>
</div>
<p>주목하세요, AI 출력 결과가 프롬프트의 <code>format</code> 부분과 거의 일대일로 대응됩니다! 그래서 청공리의 <a href="https://stagedog.github.io/%E9%9D%92%E7%A9%BA%E8%8E%89/%E5%B7%A5%E5%85%B7%E7%BB%8F%E9%AA%8C/%E6%8F%90%E7%A4%BA%E8%AF%8D%E4%B8%AA%E4%BA%BA%E5%86%99%E6%B3%95/%E9%A2%9D%E5%A4%96%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F/">추가 출력 형식</a> 작성법이 정말 잘 작동하는 거예요.</p>
<h3 id="_10">해설<a class="headerlink" href="#_10" title="Permanent link">¶</a></h3>
<p>변수 출력 형식 프롬프트가 어떻게 작성되어 있는지 차근차근 살펴봅시다!</p>
<p><code>rule</code>과 <code>format</code> 두 부분으로 나뉩니다:</p>
<ul>
<li>
<p><code>rule</code>은 출력 규칙입니다. AI는 이 요구사항만 읽고 출력하지 않습니다. 여기서 청공리는 AI에게:</p>
<ul>
<li>변수 출력 형식을 어디에 출력해야 하는지 규정 (<code>응답 끝에</code>)</li>
<li>출력할 업데이트 명령이 JSON Patch 규범을 따라야 함을 강조; MVU가 AI 응답의 JSON Patch 명령을 파싱하여 실제로 변수를 업데이트합니다.</li>
</ul>
</li>
<li>
<p><code>format</code>은 출력 형식입니다. 청공리는 AI가 이해할 수 있는 몇 가지 특수 형식을 사용하여 출력 방법을 설명합니다:</p>
<ul>
<li><code>${설명}</code>: AI가 "설명"에 따라 해당 내용으로 대체합니다. 예: <code>복장: ${캐릭터 현재 복장 구체 묘사}</code>는 <code>복장: 분홍금색 헐렁한 T셔츠 잠옷</code>으로 출력될 수 있습니다.</li>
<li><code>$(요구)</code>: AI는 "요구"만 따르고 출력하지 않습니다. 예: <code>$(아래 내용은 영어로 출력)</code>은 AI가 이후 내용을 영어로 출력하도록 합니다.</li>
<li><code>...</code>: AI가 앞서 주어진 규칙과 내용에 따라 보충 출력합니다. 예: <code>다른 캐릭터: ...</code>는 AI가 앞서 주어진 <code>하쿠아</code> 출력 형식에 따라 다른 캐릭터의 출력을 보충합니다.</li>
<li>그 외 내용은 그대로 출력되므로, AI는 <code>&lt;UpdateVariable&gt;</code>, <code>&lt;Analysis&gt;</code>, <code>&lt;JSONPatch&gt;</code> 등의 태그를 그대로 출력합니다.</li>
</ul>
</li>
</ul>
<p><code>format</code>의 모든 출력 내용은 <code>&lt;UpdateVariable&gt;</code> 태그로 감싸져 있어, 곧 소개할 "SillyTavern 정규식"의 처리가 편리합니다. 그 안에는 <code>&lt;Analysis&gt;</code>와 <code>&lt;JSONPatch&gt;</code> 두 부분이 있으며, 각각 변수 업데이트 분석과 실제 변수 명령 출력에 해당합니다.</p>
<p>우리는 AI가 먼저 변수 업데이트 분석을 출력한 다음, 실제 변수 업데이트 명령을 출력하게 합니다. 이렇게 AI가 먼저 "초안"을 작성한 후 정식 내용을 출력하는 방식이 바로 <strong>사고 체인(CoT)</strong>의 전형적인 응용입니다.</p>
<p>주의하세요, <code>&lt;Analysis&gt;</code>가 바로 사고 체인이며, 변수 업데이트 전용 사고 체인입니다! 변수 업데이트에 추가 사고 체인이 필요하다고 오해하지 마세요.</p>
<p><code>&lt;Analysis&gt;</code> 부분에는 세 가지 사고 내용이 있으며, 청공리가 자주 사용하고 저도 꽤 유용하다고 생각하는 것들입니다:</p>
<h3 id="cot">CoT(생각의 사슬) 단계별 상세<a class="headerlink" href="#cot" title="Permanent link">¶</a></h3>
<p>AI가 변수를 업데이트하기 전에 거치는 사고 과정의 세부 단계입니다.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio"><input id="__tabbed_6_2" name="__tabbed_6" type="radio"><div class="tabbed-labels"><label for="__tabbed_6_1">영문 프롬프트</label><label for="__tabbed_6_2">한글 프롬프트 (번역)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>시나리오 시간 경과 계산</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${calculate time passed</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...}</span>
</code></pre></div><p></p>
<p><strong>스토리 진행에 따른 변수의 급격한 변동 허용 여부</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${decide whether dramatic updates are allowed as it's in a special case or the time passed is more than usual</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes/no}</span>
</code></pre></div><p></p>
<p><strong>각 변수에 설정된 <code>check</code> 규칙을 상기하고, 이를 바탕으로 업데이트 방향을 분석합니다</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${analyze every variable based on its corresponding `check`, according only to current reply instead of previous plots</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...}</span>
</code></pre></div><p></p>
</div>
<div class="tabbed-block">
<p><strong>시나리오 시간 경과 계산</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${계산된 경과 시간</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...}</span>
</code></pre></div><p></p>
<p><strong>스토리 진행에 따른 변수의 급격한 변동 허용 여부</strong> (예: 호감도 100 $\rightarrow$ 0)
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${현재 전개가 충분히 특수한지, 시간 경과가 정상 범위를 훨씬 초과했는지에 따라 변수값의 극적인 변화 허용 여부 판단</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">예/아니오}</span>
</code></pre></div><p></p>
<p><strong>각 변수에 설정된 <code>check</code> 규칙을 상기하고, 이를 바탕으로 업데이트 방향을 분석합니다</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${변수에 대응하는 `check`를 기반으로, 이전 줄거리가 아닌 현재 답변에만 근거하여 각 변수의 업데이트 필요성 분석</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...}</span>
</code></pre></div><p></p>
</div>
</div>
</div>
<p>그 중 가장 배울 가치가 있는 것은 <strong><code>변수 업데이트에 필요한 check를 회상하고, 이에 따라 업데이트 방법 분석</code></strong>입니다.</p>
<p>"변수 업데이트 규칙" 부분에서 남겨둔 문제를 기억하시나요? 변수 업데이트 규칙은 캐릭터 정의 이전, D4 같은 주의력을 덜 차지하는 위치에 배치하여 AI가 다른 프롬프트와 스토리에 더 주의하게 할 수 있습니다. 하지만 AI가 변수 업데이트 규칙에 덜 주의하기 때문에 변수 업데이트 시 실수가 늘어납니다.</p>
<p>변수 업데이트 규칙의 핵심은 <code>check</code>입니다. 이것은 AI에게 무엇을 기반으로 변수를 업데이트해야 하고 어떤 값으로 업데이트해야 하는지 알려줍니다. 우리는 변수 출력 형식의 <code>&lt;Analysis&gt;</code> 부분에서 AI가 사고 체인을 출력하여 <code>check</code>를 회상하게 합니다. 이것은 변수 업데이트 규칙을 "불러내는" 것으로, 변수 업데이트를 안정화합니다.</p>
<h3 id="sillytavern">SillyTavern 정규식<a class="headerlink" href="#sillytavern" title="Permanent link">¶</a></h3>
<p>변수 출력 형식이 있으면 AI는 응답할 때 <code>&lt;UpdateVariable&gt;</code>을 출력하여 변수를 업데이트합니다. 하지만 이 출력은 층에 저장되며, 처리하지 않으면 플레이어가 이후 게임할 때 SillyTavern이 각 층의 <code>&lt;UpdateVariable&gt;</code>도 AI에게 전송합니다.</p>
<p>하지만 분명히, AI가 출력한 <code>&lt;UpdateVariable&gt;</code>을 다시 AI에게 전송할 필요는 없습니다: <code>&lt;UpdateVariable&gt;</code>의 업데이트 명령은 이미 MVU 스크립트가 파싱하여 사용했고, AI는 이후 응답에서 변수 업데이트 형식을 안정화하기 위해 참조할 필요가 거의 없습니다  우리는 이미 월드북에 변수 출력 형식을 넣어뒀습니다.</p>
<p>모든 층의 <code>&lt;UpdateVariable&gt;</code>을 AI에게 전송하면:</p>
<ul>
<li>첫째, 토큰 낭비</li>
<li>둘째, AI가 불필요하게 이전 <code>&lt;UpdateVariable&gt;</code>을 학습하는 데 주의력을 쏟고 스토리에 덜 집중</li>
<li>셋째, AI가 게을러서 이전 <code>&lt;UpdateVariable&gt;</code>을 직접 복사하고 실제로 분석하여 변수 업데이트 방법을 생각하지 않을 수 있음!</li>
</ul>
<p>따라서 이후 생성 시 <code>&lt;UpdateVariable&gt;</code> 부분을 AI에게 전송하지 않아야 합니다  이것이 SillyTavern 정규식이 필요한 이유입니다.</p>
<p>SillyTavern 정규식은 AI 응답과 사용자 입력의 특정 텍스트를 캡처하여, 특정 용도에서 지정된 내용으로 대체할 수 있습니다:</p>
<ul>
<li>프롬프트만 형식 지정: AI에게 전송 시 지정된 내용으로 대체</li>
<li>표시만 형식 지정: SillyTavern에서 표시 시 지정된 내용으로 대체</li>
<li>둘 다 체크 안 함: AI 출력을 받거나 사용자 입력이 전송될 때 영구적으로 대체</li>
</ul>
<p align="center">
  <a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/031a7caf-1590-41cd-9ca7-81ae99b945f7.jpg" data-desc-position="bottom"><img src="https://vwdygpvfycixugqsgwgn.supabase.co/storage/v1/object/public/post-images/1980dc04-3f08-4581-88cb-b949a10d585b/031a7caf-1590-41cd-9ca7-81ae99b945f7.jpg" width="500"></a>
</p>

<div class="admonition tip">
<p class="admonition-title">팁</p>
<p>위 설명이 아직 이해가 안 된다면, 자신의 SillyTavern에 있는 프리셋 배포 정규식이나 캐릭터 카드의 미화 정규식을 살펴보세요.</p>
</div>
<p>편의를 위해 청공리가 이미 <code>&lt;UpdateVariable&gt;</code> 변수 업데이트 처리용 SillyTavern 정규식을 미리 만들어 두었습니다. 다음 버전 중 하나의 정규식 3개만 다운로드하여 가져오면 됩니다:</p>
<ul>
<li><strong>미화 버전</strong> (<a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/%E7%BE%8E%E5%8C%96%E7%89%88.mp4">데모 보기</a>): <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E4%B8%8D%E5%8F%91%E9%80%81]%E5%8E%BB%E9%99%A4%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0.json?inline=false">[미전송]변수 업데이트 제거</a>, <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E7%BE%8E%E5%8C%96]%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0%E4%B8%AD.json?inline=false">[미화]변수 업데이트 중</a>, <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E7%BE%8E%E5%8C%96]%E5%AE%8C%E6%95%B4%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0.json?inline=false">[미화]전체 변수 업데이트</a></li>
<li><strong>접기 버전</strong> (<a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/%E6%8A%98%E5%8F%A0%E7%89%88.mp4">데모 보기</a>): <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E4%B8%8D%E5%8F%91%E9%80%81]%E5%8E%BB%E9%99%A4%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0.json?inline=false">[미전송]변수 업데이트 제거</a>, <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E6%8A%98%E5%8F%A0]%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0%E4%B8%AD.json?inline=false">[접기]변수 업데이트 중</a>, <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E6%8A%98%E5%8F%A0]%E5%AE%8C%E6%95%B4%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0.json?inline=false">[접기]전체 변수 업데이트</a></li>
<li><strong>힌트만 버전</strong> (펼쳐서 내용 확인 불가): <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E4%B8%8D%E5%8F%91%E9%80%81]%E5%8E%BB%E9%99%A4%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0.json?inline=false">[미전송]변수 업데이트 제거</a>, <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E6%8F%90%E7%A4%BA]%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0%E4%B8%AD.json?inline=false">[힌트]변수 업데이트 중</a>, <a href="https://gitgud.io/StageDog/tavern_resource/-/raw/main/src/%E6%AD%A3%E5%88%99/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0/regex-[%E6%8F%90%E7%A4%BA]%E5%AE%8C%E6%95%B4%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0.json?inline=false">[힌트]전체 변수 업데이트</a></li>
</ul>
<p>그 중:</p>
<ul>
<li><code>변수 업데이트 제거</code>는 정규식의 <strong>프롬프트만 형식 지정</strong> 기능을 이용하여, AI에게 전송 시 전체 <code>&lt;UpdateVariable&gt;</code> 부분을 빈 문자열로 대체합니다.</li>
<li><code>변수 업데이트 중</code>과 <code>전체 변수 업데이트</code>는 정규식의 <strong>표시만 형식 지정</strong> 기능을 이용하여, <code>&lt;UpdateVariable&gt;</code> 표시를 미화하고 플레이어가 업데이트 발생 여부를 확인하되 업데이트 내용은 숨깁니다.</li>
</ul>
<p>하지만 <code>변수 업데이트 제거</code>는 기본적으로 모든 층의 <code>&lt;UpdateVariable&gt;</code>을 AI에게 전송하지 않습니다. 때로는 마지막 한두 층을 AI에게 전송하는 것도 선택지입니다: 모든 층의 <code>&lt;UpdateVariable&gt;</code>을 AI에게 전송하지 않으면, AI가 모든 스토리를 기반으로 변수를 업데이트해야 한다고 오해하여 이전에 했어야 할 업데이트를 반복할 수 있습니다.</p>
<p>이런 스토리 기반 변수 업데이트 반복 문제가 발생하면, 마지막 한두 층의 변수를 AI에게 전송하도록 선택할 수 있습니다.</p>
<p>이를 위해 SillyTavern 정규식의 <code>최소 깊이</code> 기능을 사용할 수 있습니다. 이것은 SillyTavern 정규식이 최소 특정 깊이인 층에만 적용되도록 제한합니다:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>깊이 3: 끝에서 4번째 층, 보통 AI 응답
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>깊이 2: 끝에서 3번째 층, 보통 사용자 입력
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>깊이 1: 끝에서 2번째 층, 보통 마지막 AI 응답
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>깊이 0: 끝에서 1번째 층, 보통 마지막 사용자 입력
</code></pre></div>
<p>즉, <code>변수 업데이트 제거</code>의 최소 깊이를 <code>4</code>로 설정하면, 끝에서 5번째 층 이상에만 적용됩니다... 이렇게 하면 마지막 한두 층의 변수 업데이트 상황을 AI에게 전송하게 됩니다! (물론 대가는 앞서 말한 토큰 낭비, 주의력 낭비, AI가 게을러서 이전 <code>&lt;UpdateVariable&gt;</code>을 학습하고 실제로 분석하여 업데이트 방법을 생각하지 않는 것입니다)</p>
<h3 id="_11">변수 업데이트 강조<a class="headerlink" href="#_11" title="Permanent link">¶</a></h3>
<p>D0에 변수 출력 형식을 설정해도, 일부 모델이나 프리셋은 요구대로 <code>&lt;UpdateVariable&gt;...&lt;/UpdateVariable&gt;</code>을 출력하여 변수를 업데이트하지 않을 수 있습니다.</p>
<p>이런 상황이 발생하면, 청공리가 <strong><a href="https://stagedog.github.io/%E9%9D%92%E7%A9%BA%E8%8E%89/%E5%B7%A5%E5%85%B7%E7%BB%8F%E9%AA%8C/%E6%8F%90%E7%A4%BA%E8%AF%8D%E4%B8%AA%E4%BA%BA%E5%86%99%E6%B3%95/%E9%A2%9D%E5%A4%96%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F/"><u>추가 출력 형식</u></a></strong>에서 언급한 것처럼, D0에 변수 출력 형식에 출력 형식 강조를 추가할 수 있습니다:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="nn">---</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="nt">변수 출력 형식 강조</span><span class="p">:</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">  </span><span class="nt">rule</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">The following must be inserted to the end of reply, and cannot be omitted</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">  </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="w">    </span><span class="no">&lt;UpdateVariable&gt;</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">    </span><span class="no">...</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="w">    </span><span class="no">&lt;/UpdateVariable&gt;</span>
</code></pre></div>
<h3 id="_12">다른 오프닝에 다른 변수 초기값 설정하기 (증분 방식)<a class="headerlink" href="#_12" title="Permanent link">¶</a></h3>
<p><a href="../02-%EB%B3%80%EC%88%98-%EC%84%A4%EC%A0%95/#다른-오프닝에-다른-변수-초기값-설정하기">다른 오프닝에 다른 변수 초기값 설정하기 (전량 방식)</a>에서, <code>&lt;initvar&gt;...&lt;/initvar&gt;</code> 블록을 사용하여 다른 오프닝에 다른 변수 초기값을 설정하는 방법을 소개했습니다.</p>
<p>하지만 이 방법은 각 오프닝마다 변수 초기값을 완전히 다시 작성해야 합니다. 예를 들어, <code>[initvar]</code> 항목과 오프닝 2가 <code>좌절모드스위치</code>만 다른데도, 오프닝 2에 전체 변수 구조를 작성해야 합니다:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio"><input id="__tabbed_7_2" name="__tabbed_7" type="radio"><div class="tabbed-labels"><label for="__tabbed_7_1">[initvar] 항목</label><label for="__tabbed_7_2">오프닝 2</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nt">시라카와리</span><span class="p">:</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">  </span><span class="nt">호감도</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">  </span><span class="nt">고독감</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">  </span><span class="nt">연인관계</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">  </span><span class="nt">사망</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">  </span><span class="nt">좌절 스토리 스위치</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="nt">시라카와리</span><span class="p">:</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">  </span><span class="nt">호감도</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">  </span><span class="nt">고독감</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">  </span><span class="nt">연인관계</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">  </span><span class="nt">사망</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">  </span><span class="nt">좌절 스토리 스위치</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
</div>
</div>
<p>너무 번거롭죠! 변수 딱 하나만 바꾸고 싶을 뿐인데... <code>&lt;initvar&gt;...&lt;/initvar&gt;</code> 블록으로 변수 초기값을 완전히 다시 설정하는 것 외에도, <code>[initvar]</code> 항목에서 설정한 변수 초기값을 부분적으로만 수정할 수도 있습니다.</p>
<p>이를 위해 변수 출력 형식이 어떻게 작동하는지 다시 이해해 봅시다:</p>
<ul>
<li>AI는 변수 출력 형식에 따라, 먼저 변수 업데이트 분석을 출력하고, 그 다음 실제 변수 업데이트 명령을 출력합니다.</li>
<li>MVU는 메시지의 변수 업데이트 명령을 읽어서 해당 변수를 업데이트합니다.</li>
<li>이 업데이트 과정은 각 층에서 진행됩니다: <code>initvar 설정 변수값</code> → <code>0층 업데이트 후 변수값</code> → <code>1층 업데이트 후 변수값</code> → …</li>
<li>각 층은 자신의 층의 변수값을 저장하므로, SillyTavern 입력창 왼쪽 마법봉 ‣ 변수 관리자 ‣ 메시지 층에서 각 층의 변수값을 확인할 수 있고, 층 삭제 시 변수도 정상적으로 롤백됩니다.</li>
</ul>
<p>다시 한번 강조하면, "이 업데이트 과정은 각 층에서 진행됩니다". 맞습니다! 오프닝 메시지 (0층)에서도 변수 업데이트 명령으로 변수를 업데이트할 수 있습니다!</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nx">오프닝</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="nx">스토리</span><span class="p">...</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="o">&lt;</span><span class="nx">UpdateVariable</span><span class="o">&gt;</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="o">&lt;</span><span class="nx">JSONPatch</span><span class="o">&gt;</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="p">[</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="hll"><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="s2">"op"</span><span class="o">:</span><span class="w"> </span><span class="s2">"replace"</span><span class="p">,</span><span class="w"> </span><span class="s2">"path"</span><span class="o">:</span><span class="w"> </span><span class="s2">"/시라카와리/좌절 스토리 스위치"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
</span><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="p">]</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="o">&lt;</span><span class="err">/JSONPatch&gt;</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="o">&lt;</span><span class="err">/UpdateVariable&gt;</span>
</code></pre></div>
<p><code>&lt;JSONPatch&gt;</code> 부분이 복잡해 보이시나요? 괜찮습니다! 우리에게는 이미 변수 출력 형식이 있습니다. 오프닝 스토리를 AI에게 보내면 AI가 해당하는 변수 업데이트 명령을 생성해 줄 것입니다.</p>
<hr>
<h2 id="_13">두 가지 변수 업데이트 방식 지원<a class="headerlink" href="#_13" title="Permanent link">¶</a></h2>
<p>AI가 스토리에 집중할 수 있도록, MVU는 플레이어가 자유롭게 선택할 수 있는 두 가지 변수 업데이트 방식을 지원합니다:</p>
<ul>
<li><strong>AI 출력과 함께</strong>: AI가 먼저 스토리를 출력한 다음 변수 업데이트 명령을 출력</li>
<li><strong>추가 모델 파싱</strong>: 먼저 한 AI가 전문적으로 스토리를 출력하고, 다른 AI가 전문적으로 스토리를 파싱하여 변수 업데이트 명령을 출력</li>
</ul>
<p align="center">
  <a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="https://stagedog.github.io/_images/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0%E6%96%B9%E5%BC%8F.png" data-desc-position="bottom"><img src="https://stagedog.github.io/_images/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0%E6%96%B9%E5%BC%8F.png" width="400"></a>
</p>

<p>문지기 카드 작성 도우미로 3대 변수 프롬프트를 생성했다면, 생성된 항목 이름이 <code>변수 목록</code>, <code>[mvu_update]변수 업데이트 규칙</code>, <code>[mvu_update]변수 출력 형식</code>임을 알 수 있습니다. <code>[mvu_update]</code> 접두사가 바로 두 가지 변수 업데이트 방식을 지원하기 위한 것입니다:</p>
<ul>
<li><strong>AI 출력과 함께</strong>: 모든 항목이 정상적으로 AI에게 전송됩니다.</li>
<li><strong>추가 모델 파싱</strong>:<ul>
<li>이름에 <code>[mvu_plot]</code>이 있는 항목은 스토리 출력 담당 AI에게만 전송</li>
<li>이름에 <code>[mvu_update]</code>가 있는 항목은 변수 업데이트 담당 AI에게만 전송. 따라서 <code>변수 업데이트 규칙</code>과 <code>변수 출력 형식</code> 앞에 <code>[mvu_update]</code>가 추가됨</li>
<li>이름에 <code>[mvu_plot]</code>도 <code>[mvu_update]</code>도 없는 항목은 두 AI 모두에게 전송</li>
</ul>
</li>
</ul>
<p>즉, 이 튜토리얼대로 <code>변수 목록</code>, <code>[mvu_update]변수 업데이트 규칙</code>, <code>[mvu_update]변수 출력 형식</code>으로 변수 프롬프트를 작성하면, 당신의 캐릭터 카드는 이미 두 가지 변수 업데이트 방식을 지원합니다!</p>
<p>물론 다른 항목 이름에 <code>[mvu_plot]</code> 또는 <code>[mvu_update]</code>를 추가하여, "추가 모델 파싱" 업데이트 방식에서 어떤 프롬프트를 전송할지 더 세밀하게 제어할 수 있습니다.</p>
<p>예를 들어 다른 출력 형식이 있다면, 변수 업데이트 AI에 간섭을 주지 않기 위해 <code>[mvu_plot]</code>으로 스토리 출력 담당 AI에게만 전송되도록 지정할 수 있습니다: <code>[mvu_plot]스토리 사고 체인</code>.</p>
<p>이렇게 이름을 수정해도 항목이 어느 AI에게 전송될지만 구분하며, 월드북 항목의 그린라이트 등 기능은 여전히 작동합니다.</p>
<div class="admonition tip">
<p class="admonition-title">팁</p>
<p>이름에 <code>[mvu_plot]</code> 또는 <code>[mvu_update]</code>만 포함되면 됩니다! <code>[mvu_update]변수 업데이트 규칙</code>과 <code>변수 업데이트 규칙[mvu_update]</code>는 효과가 같습니다.</p>
</div>
<hr>
<h2 id="_14">변수 프롬프트는 단지 프롬프트일 뿐<a class="headerlink" href="#_14" title="Permanent link">¶</a></h2>
<p>변수 목록, 변수 업데이트 규칙, 변수 출력 형식 등은 모두 우리가 <strong>월드 인포(World Info)</strong>에 작성하는 프롬프트의 일부일 뿐입니다.</p>
<p>위 튜토리얼에서는 문지기(Gatekeeper) 캐릭터 작성 도우미가 사용하는 버전을 제시했지만, 여러분이 직접 독자적인 버전을 설계해도 완전히 무방합니다!</p>
<p>또한, 일부 변수는 특정 상황에서만 필요할 수도 있습니다. 예를 들어 '임무 시스템'이 특정 캐릭터와만 연관되어 있다면, 당연히 해당 캐릭터가 등장할 때만 임무 시스템 관련 프롬프트를 전송하는 것이 효율적입니다.</p>
<p>따라서 단순히 <code>{{format_message_variable::stat_data}}</code>로 모든 데이터를 뭉뚱그려 보내는 대신, 다음과 같이 나누어 작성할 수 있습니다.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="l l-Scalar l-Scalar-Plain">&lt;status_current_variable&gt;</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="l l-Scalar l-Scalar-Plain">캐릭터</span><span class="p p-Indicator">:</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">  </span><span class="p p-Indicator">{{</span><span class="nv">format_message_variable</span><span class="p p-Indicator">::</span><span class="nv">stat_data.캐릭터</span><span class="p p-Indicator">}}</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="c1"># ⬇️⬇️⬇️⬇️⬇️ Green Light(그린 라이트)나 추후 소개할 기능을 활용하여, </span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="c1"># 특정 상황에서만 아래 프롬프트를 전송하도록 설정할 수 있습니다.</span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="nt">임무 시스템</span><span class="p">:</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="w">  </span><span class="p p-Indicator">{{</span><span class="nv">format_message_variable</span><span class="p p-Indicator">::</span><span class="nv">stat_data.임무_시스템</span><span class="p p-Indicator">}}</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="c1"># ⬆️⬆️⬆️⬆️⬆️</span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="l l-Scalar l-Scalar-Plain">&lt;/status_current_variable&gt;</span>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="l l-Scalar l-Scalar-Plain">임무 시스템의 변수 업데이트 규칙도 동일하게 처리할 수 있습니다.</span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="nn">---</span>
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="c1">## 변수 프롬프트 테스트</span>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a>
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a><span class="l l-Scalar l-Scalar-Plain">이제 변수 프롬프트가 있으니, MVU 변수 프레임워크에서 **변수 업데이트 오류 시 알림**을 체크한 다음, 변수 관리자를 열어 옆에 두고 AI에게 스토리를 진행하게 요청(예</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="err">`</span><span class="l l-Scalar l-Scalar-Plain">스토리 진행`)하여 층이 `&lt;UpdateVariable&gt;` 블록을 정상 출력하는지 확인합니다.</span>
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a>
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a><span class="l l-Scalar l-Scalar-Plain">&lt;p align="center"&gt;</span>
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">&lt;img src="https://stagedog.github.io/_images/%E5%8F%98%E9%87%8F%E6%9B%B4%E6%96%B0%E5%87%BA%E9%94%99%E6%97%B6%E9%80%9A%E7%9F%A5.png" width="400"&gt;</span>
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a><span class="l l-Scalar l-Scalar-Plain">&lt;/p&gt;</span>
<a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a>
<a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="err">**`</span><span class="l l-Scalar l-Scalar-Plain">&lt;UpdateVariable&gt;` 블록이 출력되지 않으면**</span>
<a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">다른 프롬프트가 너무 많은 주의력을 차지했거나, 변수 프롬프트가 제대로 작동하지 않을 수 있습니다. 글로벌 월드북을 끄고 다른 프롬프트의 주의력을 조정하고, 변수 프롬프트가 이 장에 따라 올바르게 설정되었는지 확인하세요.</span>
<a id="__codelineno-28-25" name="__codelineno-28-25" href="#__codelineno-28-25"></a>
<a id="__codelineno-28-26" name="__codelineno-28-26" href="#__codelineno-28-26"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="err">*</span><span class="nv">*노란색</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">오류 `[MVU]변수 업데이트 오류 발생`이 나타나면 (`[MVU zod]`가 아님)**</span>
<a id="__codelineno-28-27" name="__codelineno-28-27" href="#__codelineno-28-27"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">변수 구조 스크립트에 오류가 있습니다. 변수 구조 스크립트를 껐다 켜세요. 그런 다음 PC는 F12  콘솔(devtool), 모바일은 입력창 왼쪽 하단 마법봉  로그 뷰어에서 빨간 오류가 있는지 확인하고, AI에게 변수 구조 스크립트를 다시 작성하게 하세요. 빨간 오류가 없으면 직접 다시 작성하게 하세요. 그래도 해결되지 않으면 게시물을 통해 청공리에게 문의하세요.</span>
<a id="__codelineno-28-28" name="__codelineno-28-28" href="#__codelineno-28-28"></a>
<a id="__codelineno-28-29" name="__codelineno-28-29" href="#__codelineno-28-29"></a><span class="l l-Scalar l-Scalar-Plain">위 문제가 없다면, 변수 프롬프트가 정상 작동합니다! 변수 관리자는 변수 업데이트 시 하이라이트 애니메이션을 재생한 다음 업데이트된 변수를 표시합니다.</span>
<a id="__codelineno-28-30" name="__codelineno-28-30" href="#__codelineno-28-30"></a>
<a id="__codelineno-28-31" name="__codelineno-28-31" href="#__codelineno-28-31"></a><span class="nn">---</span>
<a id="__codelineno-28-32" name="__codelineno-28-32" href="#__codelineno-28-32"></a>
<a id="__codelineno-28-33" name="__codelineno-28-33" href="#__codelineno-28-33"></a><span class="c1">## 정리</span>
<a id="__codelineno-28-34" name="__codelineno-28-34" href="#__codelineno-28-34"></a>
<a id="__codelineno-28-35" name="__codelineno-28-35" href="#__codelineno-28-35"></a><span class="nt">이로써 변수 환경 구축이 완료되었습니다</span><span class="p">:</span>
<a id="__codelineno-28-36" name="__codelineno-28-36" href="#__codelineno-28-36"></a>
<a id="__codelineno-28-37" name="__codelineno-28-37" href="#__codelineno-28-37"></a><span class="err">*</span><span class="w"> </span><span class="err">`</span><span class="l l-Scalar l-Scalar-Plain">변수 구조` 스크립트를 생성하고 만들어서 캐릭터 카드에 어떤 변수가 있는지 정의했습니다.</span>
<a id="__codelineno-28-38" name="__codelineno-28-38" href="#__codelineno-28-38"></a><span class="err">*</span><span class="w"> </span><span class="err">`</span><span class="p p-Indicator">[</span><span class="nv">initvar</span><span class="p p-Indicator">]</span><span class="l l-Scalar l-Scalar-Plain">변수 초기화(열지 말것)` 항목과 오프닝의 `&lt;initvar&gt;` 블록으로 각 오프닝에 초기값을 설정했습니다.</span>
<a id="__codelineno-28-39" name="__codelineno-28-39" href="#__codelineno-28-39"></a><span class="nt">* 변수 프롬프트를 설계하여 AI가 변수를 이해하게 했습니다</span><span class="p">:</span>
<a id="__codelineno-28-40" name="__codelineno-28-40" href="#__codelineno-28-40"></a><span class="w">    </span><span class="err">*</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">변수 목록을 통해 현재 변수 상황을 이해</span>
<a id="__codelineno-28-41" name="__codelineno-28-41" href="#__codelineno-28-41"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">* 변수 업데이트 규칙을 통해 변수가 어떤 상황에서 업데이트되어야 하고 어떤 값으로 변해야 하는지 이해</span>
<a id="__codelineno-28-42" name="__codelineno-28-42" href="#__codelineno-28-42"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">* 변수 출력 형식을 통해 변수를 업데이트하기 위해 무엇을 출력해야 하는지 이해</span>
<a id="__codelineno-28-43" name="__codelineno-28-43" href="#__codelineno-28-43"></a><span class="err">*</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SillyTavern 정규식 세트를 가져와서 이전 `&lt;UpdateVariable&gt;` 블록이 AI에게 다시 전송되지 않게 하여 AI의 과적합을 방지했습니다.</span>
<a id="__codelineno-28-44" name="__codelineno-28-44" href="#__codelineno-28-44"></a>
<a id="__codelineno-28-45" name="__codelineno-28-45" href="#__codelineno-28-45"></a><span class="l l-Scalar l-Scalar-Plain">이 환경은 이미 전통적인, 매 층마다 모든 텍스트를 완전히 출력해야 하는 상태바를 효과적으로 대체할 수 있으며, AI에게 현재 스토리 상태를 정확하게 알려줍니다!</span>
<a id="__codelineno-28-46" name="__codelineno-28-46" href="#__codelineno-28-46"></a>
<a id="__codelineno-28-47" name="__codelineno-28-47" href="#__codelineno-28-47"></a><span class="l l-Scalar l-Scalar-Plain">하지만 변수가 할 수 있는 것은 이것만이 아닙니다.</span>
<a id="__codelineno-28-48" name="__codelineno-28-48" href="#__codelineno-28-48"></a>
<a id="__codelineno-28-49" name="__codelineno-28-49" href="#__codelineno-28-49"></a><span class="l l-Scalar l-Scalar-Plain">앞서 언급했듯이, `하쿠아.의존도`의 경우 AI는 이름에서 하쿠아가 주인공에게 갖는 의존 정도라는 것을 알 수 있지만, 구체적인 수치(예</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">23)에서 하쿠아가 어떤 심리 상태여야 하는지, 어떤 행동을 취하는 경향이 있는지는 추가 설명이 필요합니다.</span>
<a id="__codelineno-28-50" name="__codelineno-28-50" href="#__codelineno-28-50"></a>
<a id="__codelineno-28-51" name="__codelineno-28-51" href="#__codelineno-28-51"></a><span class="nt">당시 우리의 선택은 새로운 `캐릭터 단계` 항목을 만들어 각 의존도 단계에서 하쿠아의 행동을 나열하는 것이었습니다</span><span class="p">:</span>
<a id="__codelineno-28-52" name="__codelineno-28-52" href="#__codelineno-28-52"></a>
<a id="__codelineno-28-53" name="__codelineno-28-53" href="#__codelineno-28-53"></a><span class="err">```</span><span class="l l-Scalar l-Scalar-Plain">yaml</span>
<a id="__codelineno-28-54" name="__codelineno-28-54" href="#__codelineno-28-54"></a><span class="nt">하쿠아의 현재 행동</span><span class="p">:</span><span class="w"> </span>
<a id="__codelineno-28-55" name="__codelineno-28-55" href="#__codelineno-28-55"></a><span class="w">  </span><span class="c1"># 하쿠아의 현재 의존도는 {{format_message_variable::stat_data.하쿠아.의존도}}이므로, 다음 예시와 유사한 행동을 하는 경향이 있음</span>
<a id="__codelineno-28-56" name="__codelineno-28-56" href="#__codelineno-28-56"></a><span class="w">  </span><span class="c1"># 0~19 일 때</span>
<a id="__codelineno-28-57" name="__codelineno-28-57" href="#__codelineno-28-57"></a><span class="w">  </span><span class="nt">소극적 자기 파괴</span><span class="p">:</span>
<a id="__codelineno-28-58" name="__codelineno-28-58" href="#__codelineno-28-58"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<a id="__codelineno-28-59" name="__codelineno-28-59" href="#__codelineno-28-59"></a><span class="w">  </span><span class="c1"># 20~39 일 때</span>
<a id="__codelineno-28-60" name="__codelineno-28-60" href="#__codelineno-28-60"></a><span class="w">  </span><span class="nt">시선 갈구</span><span class="p">:</span>
<a id="__codelineno-28-61" name="__codelineno-28-61" href="#__codelineno-28-61"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<a id="__codelineno-28-62" name="__codelineno-28-62" href="#__codelineno-28-62"></a><span class="w">  </span><span class="c1"># 40~59 일 때</span>
<a id="__codelineno-28-63" name="__codelineno-28-63" href="#__codelineno-28-63"></a><span class="w">  </span><span class="nt">은밀한 접근</span><span class="p">:</span>
<a id="__codelineno-28-64" name="__codelineno-28-64" href="#__codelineno-28-64"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<a id="__codelineno-28-65" name="__codelineno-28-65" href="#__codelineno-28-65"></a><span class="w">  </span><span class="c1"># 60~79 일 때</span>
<a id="__codelineno-28-66" name="__codelineno-28-66" href="#__codelineno-28-66"></a><span class="w">  </span><span class="nt">불안한 의존</span><span class="p">:</span>
<a id="__codelineno-28-67" name="__codelineno-28-67" href="#__codelineno-28-67"></a><span class="w">  </span><span class="c1"># 80~100 일 때</span>
<a id="__codelineno-28-68" name="__codelineno-28-68" href="#__codelineno-28-68"></a><span class="w">  </span><span class="nt">유순한 의존</span><span class="p">:</span>
<a id="__codelineno-28-69" name="__codelineno-28-69" href="#__codelineno-28-69"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">모든 단계의 프롬프트를 전송할 때의 문제점</p>
<p>하지만 이 방식에는 분명한 문제가 있습니다. </p>
<p>현재 하쿠아의 의존도가 <strong>23</strong>임에도 불구하고, 우리는 여전히 <strong>0~19, 40~59 등 해당하지 않는 단계의 프롬프트까지 모두 전송</strong>하고 있다는 점입니다. </p>
<p>이는 입력 토큰을 낭비할 뿐만 아니라, AI의 주의력을 분산시켜 AI가 하쿠아에게 어떤 단계의 행동을 취하게 해야 할지 혼란을 줄 수 있습니다.</p>
</div>
<p>만약 현재 의존도에 딱 맞춰서, <strong>그에 해당하는 프롬프트만 전송</strong>할 수 있다면 얼마나 좋을까요!</p>
<p>만약 의존도가 100에 도달했을 때, <strong>미리 작성해 둔 고백 이벤트</strong>를 딱 트리거할 수 있다면 얼마나 좋을까요! ...물론, <strong>가능합니다.</strong> 😈
다음 페이지에서 설명드리겠습니다.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  맨위로
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.indexes", "navigation.top", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "toc.follow"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\ud074\ub9bd\ubcf4\ub4dc\uc5d0 \ubcf5\uc0ac\ub428", "clipboard.copy": "\ud074\ub9bd\ubcf4\ub4dc\ub85c \ubcf5\uc0ac", "search.result.more.one": "\uc774 \ubb38\uc11c\uc5d0\uc11c 1\uac1c\uc758 \uac80\uc0c9 \uacb0\uacfc \ub354 \ubcf4\uae30", "search.result.more.other": "\uc774 \ubb38\uc11c\uc5d0\uc11c #\uac1c\uc758 \uac80\uc0c9 \uacb0\uacfc \ub354 \ubcf4\uae30", "search.result.none": "\uac80\uc0c9\uc5b4\uc640 \uc77c\uce58\ud558\ub294 \ubb38\uc11c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4", "search.result.one": "1\uac1c\uc758 \uc77c\uce58\ud558\ub294 \ubb38\uc11c", "search.result.other": "#\uac1c\uc758 \uc77c\uce58\ud558\ub294 \ubb38\uc11c", "search.result.placeholder": "\uac80\uc0c9\uc5b4\ub97c \uc785\ub825\ud558\uc138\uc694", "search.result.term.missing": "\ud3ec\ud568\ub418\uc9c0 \uc54a\uc740 \uac80\uc0c9\uc5b4", "select.version": "\ubc84\uc804 \uc120\ud0dd"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>